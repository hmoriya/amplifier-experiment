# Operation: op-005 浄水プロセス設計 [DesignPurification]

## 概要

| 項目 | 値 |
|------|-----|
| ID | op-005 |
| 日本語名 | 浄水プロセス設計 |
| 英語名 | DesignPurification |
| 定数名 | DESIGN_PURIFICATION |
| 所属Capability | cap-003 浄水技術 |
| ステータス | Draft |

## 説明

水源の特性と製品要件に基づき、最適な浄水プロセスを設計する。
プロセスフロー、パラメータ、設備要件を定義し、シミュレーションを実施する。

## 事前条件

- 対象水源の水質データが存在すること
- 製品の品質基準が設定済みであること
- 設計者が技術研究者であること

## 事後条件

- 浄水プロセス設計書が作成されていること
- シミュレーション結果が記録されていること
- レビュー待ちステータスになっていること

## 入力

| パラメータ | 型 | 必須 | 説明 |
|------------|-----|------|------|
| sourceId | UUID | Yes | 対象水源ID |
| productCategory | String | Yes | 製品カテゴリ |
| targetQuality | QualityParameter[] | Yes | 目標品質パラメータ |
| constraints | Constraint[] | No | 制約条件（コスト、設備等） |
| designedBy | UUID | Yes | 設計者ID |

## 出力

| フィールド | 型 | 説明 |
|------------|-----|------|
| processId | UUID | プロセスID |
| version | String | バージョン（v1.0.0形式） |
| flowDiagram | String | フロー図（SVG） |
| parameters | ProcessParameter[] | プロセスパラメータ |
| simulationResult | SimulationResult | シミュレーション結果 |
| status | Enum | ステータス（DRAFT/REVIEW/APPROVED） |

## ビジネスルール

1. **BR-001**: 入力水質から目標水質への到達可能性を検証すること
2. **BR-002**: コスト制約がある場合、制約内で設計すること
3. **BR-003**: 設計はレビュー承認後に確定
4. **BR-004**: 過去の類似設計を参照可能とすること

## 例外・エラー

| エラーコード | 条件 | メッセージ |
|--------------|------|------------|
| E001 | 水質データ不足 | 水源の水質データが不足しています |
| E002 | 到達不可能 | 現在の技術では目標品質に到達できません |
| E003 | 制約超過 | コスト制約を満たす設計ができません |

## 関連UseCase

| ID | 名称 |
|----|------|
| uc-005 | プロセス設計 [ProcessDesign] |

## シーケンス

```
1. 設計要件を受け付ける
2. 水源の水質データを取得する
3. 目標品質との差分を分析する
4. 最適なプロセスを選定する
5. パラメータを設定する
6. シミュレーションを実行する
7. 設計書を生成する
8. レビュー依頼を送信する
```

## ドメインイベント

| イベント | 発行条件 |
|----------|----------|
| PurificationProcessDesigned | 設計完了時 |
| PurificationProcessApproved | 承認時 |

---

**作成日**: 2025-12-05
**更新日**: 2025-12-05
**作成者**: AI Assistant
