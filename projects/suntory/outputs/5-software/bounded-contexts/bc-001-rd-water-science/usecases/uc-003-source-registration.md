# UseCase: uc-003 水源登録 [SourceRegistration]

## 概要

| 項目 | 値 |
|------|-----|
| ID | uc-003 |
| 日本語名 | 水源登録 |
| 英語名 | SourceRegistration |
| 定数名 | SOURCE_REGISTRATION |
| 関連Operation | op-003 水源登録 |
| 関連Page | page-003 水源登録画面 |
| ステータス | Draft |

## アクター

- **主アクター**: 水源管理担当者

## 概要説明

水源管理担当者が新規に発見または取得した水源をシステムに登録する。
位置情報、基本情報、初回検査結果を紐付けて管理を開始する。

## 事前条件

- 担当者がシステムにログイン済みであること
- 水源の位置情報が取得済みであること
- 初回水質検査が完了していること

## 事後条件

- 水源がシステムに登録されていること
- 水源マップに表示されていること
- 初回検査結果が紐付けられていること

## 基本フロー

1. 担当者は「水源登録画面」を開く
2. システムは登録フォームを表示する
3. 担当者は水源名を入力する
4. 担当者は位置情報を地図上でピン留めまたは座標入力する
5. システムは住所を自動取得して表示する
6. 担当者は水源種別（地下水/湧水/河川/その他）を選択する
7. 担当者は発見日を入力する
8. 担当者は初回水質検査IDを入力または選択する
9. システムは検査結果を表示し、合格を確認する
10. 担当者は「登録」をクリックする
11. システムは重複チェックを実行する
12. システムは水源を登録し、水源IDを発行する
13. システムは水源マップを更新する

## 代替フロー

### ALT-1: 検査不合格の水源登録

- 発生条件: 初回検査が不合格の場合
- フロー:
  1. システムは警告メッセージを表示する
  2. 担当者は「調査中として登録」を選択できる
  3. 水源はUNDER_REVIEWステータスで登録される

## 例外フロー

### EXC-1: 重複水源

- 発生条件: 半径100m以内に既存水源が存在
- フロー:
  1. システムは既存水源情報を表示する
  2. 担当者は「別水源として登録」または「キャンセル」を選択する

## ビジネスルール

| ルールID | ルール | 説明 |
|----------|--------|------|
| BR-001 | 重複チェック | 半径100m以内の既存水源を検出 |
| BR-002 | 検査必須 | 初回水質検査が必須 |
| BR-003 | 国内限定 | 日本国内の水源のみ登録可 |
| BR-004 | 名称一意 | 水源名は一意であること |

## UI要件

- 位置情報は地図上でインタラクティブに選択可能
- 住所は位置情報から自動取得
- 検査ID入力時に検査結果サマリーを表示
- 登録完了後、水源マップに遷移

## 非機能要件

| 項目 | 要件 |
|------|------|
| パフォーマンス | 地図表示3秒以内、登録処理2秒以内 |
| セキュリティ | 位置情報は機密扱い |
| 可用性 | 業務時間内99.9%稼働 |

---

**作成日**: 2025-12-05
**更新日**: 2025-12-05
**作成者**: AI Assistant
