# ADR-001: マイクロサービスアーキテクチャの採用

## ステータス

**承認済み** (2025-11-27)

## コンテキスト

アサヒグループのR&D部門（VS2: 製品開発・イノベーション）のシステムアーキテクチャを決定する必要がある。

**現状の課題:**
- 複数の研究所・開発部門が独立してシステムを運用
- データのサイロ化により、部門間連携が困難
- システム変更時の影響範囲が広く、リリース頻度が低い
- 特定機能のスケーリングが困難

**要件:**
- 各部門の独立性を維持しながら、データ連携を実現
- 迅速な機能追加・変更が可能
- 負荷に応じた柔軟なスケーリング
- 障害の局所化

## 決定

**マイクロサービスアーキテクチャを採用する。**

VS2を7つの独立したサービスに分割:
1. Fermentation Research Service（発酵研究）
2. Ingredient Research Service（素材研究）
3. Beer Development Service（ビール開発）
4. Spirits Development Service（スピリッツ開発）
5. Beverage Development Service（飲料開発）
6. R&D Support Service（R&D支援）
7. Process Engineering Service（プロセス技術）

## 結果

### 良い影響

1. **独立したデプロイ**: 各サービスを独立してデプロイ可能。リリース頻度向上。
2. **チーム自律性**: 各チームが自身のサービスを所有し、技術選択の自由度が高い。
3. **スケーラビリティ**: 負荷の高いサービスのみスケールアウト可能。
4. **障害分離**: 1つのサービスの障害が全体に波及しにくい。
5. **技術的多様性**: サービスごとに最適な技術スタックを選択可能。

### 悪い影響/トレードオフ

1. **運用複雑性の増加**: 複数サービスの監視・管理が必要。
2. **分散システムの難しさ**: ネットワーク障害、データ整合性の課題。
3. **サービス間通信のオーバーヘッド**: モノリスより通信コストが高い。
4. **テストの複雑化**: 統合テスト、E2Eテストの難易度上昇。
5. **初期構築コスト**: インフラ・CI/CDパイプラインの整備が必要。

### リスク

1. **分散モノリス化**: サービス間の結合度が高くなると、マイクロサービスの利点を失う。
   - 対策: Context Mapによる明確な境界定義、イベント駆動による疎結合化
2. **データ整合性**: 分散トランザクションの管理が困難。
   - 対策: Sagaパターン、最終的整合性の受容
3. **スキル不足**: マイクロサービス運用経験の不足。
   - 対策: 段階的移行、外部専門家の支援

## 代替案

### 代替案1: モノリシックアーキテクチャ

**評価:**
- メリット: 開発・運用がシンプル、データ整合性が容易
- デメリット: スケーラビリティに限界、変更影響範囲が広い
- 判断: 長期的なスケーラビリティ・柔軟性の要件を満たせない

### 代替案2: モジュラーモノリス

**評価:**
- メリット: モノリスのシンプルさ + モジュール分離
- デメリット: デプロイは全体一括、スケーリングの柔軟性が低い
- 判断: 将来的なマイクロサービス移行への中間段階としては有効だが、最終形態としては不十分

### 代替案3: サーバーレスアーキテクチャ

**評価:**
- メリット: 運用負荷低減、自動スケーリング
- デメリット: ベンダーロックイン、コールドスタート問題、複雑なワークフロー管理
- 判断: R&D業務の複雑性・長時間処理には不向き

## 関連

- ADR-002: イベントバスとしてKafkaを選択
- ADR-003: API Gatewayパターンの採用
- ADR-004: Database per Serviceパターン
- service-boundaries.md
- context-map.md

---

**作成者:** Claude (Parasol V4 Lite)
**作成日:** 2025-11-27
