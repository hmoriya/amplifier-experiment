# CL3→BC抽出フロー ASCII図

Parasol V5 - 問題領域から解決領域への移行

---

## 1. ZIGZAGの本質：問題領域と解決領域の往復

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│              ZIGZAG = 問題領域と解決領域を行ったり来たりする創発的思考               │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  問題領域（Problem Space）で考えが行き詰まった時、                                  │
│  解決領域（Solution Space）の視点で見ることで、                                     │
│  問題領域の新たな側面が見えてくる。                                                 │
│                                                                                     │
│  逆に、解決領域で行き詰まった時、                                                   │
│  問題領域に戻ることで、解決の糸口が見える。                                         │
│                                                                                     │
│  この「行ったり来たり」が創発を生む。                                               │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### ZIGZAGの動き

```
  ┌─────────────────────────────────┐         ┌─────────────────────────────────┐
  │      問題領域                    │         │      解決領域                    │
  │   (Problem Space)               │         │   (Solution Space)              │
  │                                 │         │                                 │
  │   「何を解決するか」            │         │   「どう解決するか」            │
  │   ビジネスの言葉で考える        │         │   技術の言葉で考える            │
  │                                 │         │                                 │
  │   ┌─────────────────────────┐   │         │   ┌─────────────────────────┐   │
  │   │ CL1: 活動領域           │   │         │   │ BC: 境界付きコンテキスト│   │
  │   │ CL2: ケイパビリティ     │   │         │   │ Service: サービス設計   │   │
  │   │ CL3: 業務オペレーション │   │         │   │ 実装: コード            │   │
  │   └─────────────────────────┘   │         │   └─────────────────────────┘   │
  │                                 │         │                                 │
  └────────────────┬────────────────┘         └────────────────┬────────────────┘
                   │                                           │
                   │         ╔═══════════════════════╗         │
                   │         ║                       ║         │
                   └────────▶║       ZIGZAG!        ◀─────────┘
                             ║                       ║
                   ┌─────────║  領域を横断して      ║─────────┐
                   │         ║  視点を切り替える    ║         │
                   │         ║                       ║         │
                   │         ╚═══════════════════════╝         │
                   │                                           │
                   ▼                                           ▼
         問題領域で行き詰まり                        解決領域で行き詰まり
              ↓                                          ↓
         解決領域へ移動                              問題領域へ移動
              ↓                                          ↓
         新しい視点で見る                            本質に立ち返る
              ↓                                          ↓
         問題領域の新側面が創発                      解決のヒントが創発
```

### 具体例：「認証機能」のZIGZAG

```
  問題領域                                    解決領域
  ─────────────────────────────────────────────────────────────────────────────

  「認証機能が必要」
       │
       │ 行き詰まり：これ以上分解できない
       │
       └──────────────────────────────────────▶ 「どう実装する？」
                                                      │
                                                      ▼
                                               OAuth, JWT, Session
                                                      │
       ◀──────────────────────────────────────────────┘
       │                                        解決視点から見えた
       │                                        新しい問題領域の概念
       ▼
  「トークン管理」「セッション管理」「失効処理」  ← 創発！
       │
       │ 問題領域で新しい概念が見えた
       │
       └──────────────────────────────────────▶ 「各機能をどう設計？」
                                                      │
                                                      ▼
                                               トークンBC, セッションBC
                                                      │
       ◀──────────────────────────────────────────────┘
       │
       ▼
  「トークンライフサイクル」「認可スコープ」    ← さらに創発！
```

---

## 2. 2段階ZIGZAGモデル全体図

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                          2段階ZIGZAGモデル                                           │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ╔═══════════════════════════════════════════════════════════════════════════════╗  │
│  ║ 【第1段階】価値のZIGZAG（Phase 2）                                            ║  │
│  ║                                                                               ║  │
│  ║  価値定義領域              実現方法領域                                       ║  │
│  ║  (何を実現？)              (どう実現？)                                       ║  │
│  ║                                                                               ║  │
│  ║   ┌──────────┐                  ┌──────────────┐                              ║  │
│  ║   │ VL1-VL3  │ ───ZIGZAG───▶   │ VMS,VS0-VS7  │                              ║  │
│  ║   │ 価値定義  │ ◀───ZIGZAG───  │ 実現計画     │                              ║  │
│  ║   └──────────┘                  └──────────────┘                              ║  │
│  ║                                                                               ║  │
│  ║   行き詰まり：              行き詰まり：                                      ║  │
│  ║   「価値をどう届ける？」    「この計画で価値は実現できる？」                  ║  │
│  ║        ↓                         ↓                                           ║  │
│  ║   実現方法を考える          価値定義に戻る                                    ║  │
│  ║        ↓                         ↓                                           ║  │
│  ║   価値の新側面が見える      計画の改善点が見える                              ║  │
│  ║                                                                               ║  │
│  ╚═══════════════════════════════════════════════════════════════════════════════╝  │
│                                      │                                              │
│                                      ▼                                              │
│  ╔═══════════════════════════════════════════════════════════════════════════════╗  │
│  ║ 【第2段階】ビジネスと設計のZIGZAG（Phase 3-6）                                ║  │
│  ║                                                                               ║  │
│  ║                                                                               ║  │
│  ║   問題領域                                    解決領域                        ║  │
│  ║   (Problem Space)                            (Solution Space)                 ║  │
│  ║   「何を解決するか」                          「どう解決するか」              ║  │
│  ║                                                                               ║  │
│  ║   ┌───────────────────────┐                  ┌───────────────────────┐        ║  │
│  ║   │                       │                  │                       │        ║  │
│  ║   │  CL1: 活動領域        │                  │  BC: 境界付きCtx      │        ║  │
│  ║   │       ↓               │                  │       ↓               │        ║  │
│  ║   │  CL2: ケイパビリティ  │ ───ZIGZAG────▶  │  Service: 設計        │        ║  │
│  ║   │       ↓               │ ◀───ZIGZAG────  │       ↓               │        ║  │
│  ║   │  CL3: 業務OP         │                  │  Implementation       │        ║  │
│  ║   │                       │                  │                       │        ║  │
│  ║   └───────────────────────┘                  └───────────────────────┘        ║  │
│  ║                                                                               ║  │
│  ║   【問題領域での行き詰まり】                  【解決領域での行き詰まり】      ║  │
│  ║   ・CL3でこれ以上分解できない                ・技術だけでは判断できない       ║  │
│  ║   ・業務の境界が見えない                     ・BCの責務が不明確               ║  │
│  ║         ↓                                         ↓                          ║  │
│  ║   解決領域へ移動                              問題領域へ戻る                  ║  │
│  ║         ↓                                         ↓                          ║  │
│  ║   「どう実装する？」と問う                    「何を解決したい？」と問う       ║  │
│  ║         ↓                                         ↓                          ║  │
│  ║   BC境界が見えてくる                          業務の本質が見えてくる         ║  │
│  ║                                                                               ║  │
│  ╚═══════════════════════════════════════════════════════════════════════════════╝  │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

### ZIGZAGの核心：なぜ往復が必要か

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                           なぜZIGZAG（往復）が必要か                                 │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ❌ 問題領域だけで考える（トップダウン）                                            │
│     → 抽象度の壁にぶつかる。「認証機能」をこれ以上分解できない                      │
│                                                                                     │
│  ❌ 解決領域だけで考える（ボトムアップ）                                            │
│     → 技術に引きずられる。本当に必要な機能を見失う                                  │
│                                                                                     │
│  ✅ 両方を行ったり来たり（ZIGZAG）                                                  │
│     → 行き詰まるたびに反対側へ。新しい視点が創発を生む                              │
│                                                                                     │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│     問題領域          ZIGZAG           解決領域                                     │
│        │                ↕                 │                                        │
│   抽象度の壁   ───▶  視点転換   ◀───  技術偏重                                     │
│        │                ↕                 │                                        │
│        └───────────  創発  ───────────┘                                            │
│                                                                                     │
│  「同じ場所でぐるぐる回る」のではなく                                               │
│  「違う場所へ行って戻ってくる」ことで景色が変わる                                   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 問題領域→解決領域フロー図

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                       問題領域 → 解決領域 フロー                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘

 ╔═══════════════════════════╗   ╔═════════════════╗   ╔═══════════════════════════╗
 ║   Problem Space           ║   ║    Transition   ║   ║   Solution Space          ║
 ║   問題領域 (Phase 3)      ║   ║   (Phase 4)     ║   ║   解決領域 (Phase 5-6)    ║
 ║                           ║   ║                 ║   ║                           ║
 ║  「何を解決するか」       ║   ║  DDDマッピング  ║   ║  「どう解決するか」       ║
 ╠═══════════════════════════╣   ╠═════════════════╣   ╠═══════════════════════════╣
 ║                           ║   ║                 ║   ║                           ║
 ║  ┌─────────────────────┐  ║   ║                 ║   ║  ┌─────────────────────┐  ║
 ║  │ CL1: 活動領域識別   │  ║   ║                 ║   ║  │ BC: 境界付きCtx     │  ║
 ║  │ (WHAT)              │  ║   ║                 ║   ║  │ (WHAT)              │  ║
 ║  │ 担当: 経営層        │  ║   ║                 ║   ║  │ 担当: アーキテクト  │  ║
 ║  └──────────┬──────────┘  ║   ║                 ║   ║  └──────────┬──────────┘  ║
 ║             │             ║   ║                 ║   ║             │             ║
 ║             ▼             ║   ║                 ║   ║             ▼             ║
 ║  ┌─────────────────────┐  ║   ║                 ║   ║  ┌─────────────────────┐  ║
 ║  │ CL2: ケイパビリティ │  ║   ║  ┌───────────┐  ║   ║  │ Service: サービス   │  ║
 ║  │ (HOW)               │  ║   ║  │           │  ║   ║  │ (HOW)               │  ║
 ║  │ 担当: 事業部長/PO   │  ║   ║  │  BC境界   │  ║   ║  │ 担当: 開発リード    │  ║
 ║  └──────────┬──────────┘  ║═══║══▶   確定   │══║═══║  └──────────┬──────────┘  ║
 ║             │             ║   ║  │           │  ║   ║             │             ║
 ║             ▼             ║   ║  └───────────┘  ║   ║             ▼             ║
 ║  ┌─────────────────────┐  ║   ║                 ║   ║  ┌─────────────────────┐  ║
 ║  │ CL3: 業務オペレーション│ ║   ║  担当:         ║   ║  │ Implementation      │  ║
 ║  │ (WHAT')             │  ║   ║  アーキテクト   ║   ║  │ (WHAT')             │  ║
 ║  │ 担当: 業務担当者    │  ║   ║                 ║   ║  │ 担当: 開発者        │  ║
 ║  └─────────────────────┘  ║   ║                 ║   ║  └─────────────────────┘  ║
 ║                           ║   ║                 ║   ║                           ║
 ╚═══════════════════════════╝   ╚═════════════════╝   ╚═══════════════════════════╝

     業務担当者・ドメイン              アーキテクト           開発チーム
     エキスパートの責任                の責任                 の責任
```

---

## 3. CL3→BC抽出ステップ図

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                        CL3 → BC 抽出プロセス (Phase 4)                              │
└─────────────────────────────────────────────────────────────────────────────────────┘

                    ┌──────────────────────────────────────┐
                    │   INPUT: CL3 業務オペレーション群    │
                    │   (Phase 3c 成果物)                  │
                    └───────────────────┬──────────────────┘
                                        │
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────────┐
│ Step 1: ユビキタス言語分析                                                        │
├───────────────────────────────────────────────────────────────────────────────────┤
│  • 同じ用語・概念を使用するCL3群を識別                                            │
│  • 同一のドメイン用語を使用しているか？                                           │
│  • 同じエンティティを操作しているか？                                             │
│  • 共通のビジネスルールがあるか？                                                 │
│                                              Output: 言語グループ                 │
└───────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────────┐
│ Step 2: 凝集度評価                                                                │
├───────────────────────────────────────────────────────────────────────────────────┤
│  ┌──────────────────┬──────────────────────────────────────┬──────────────────┐   │
│  │ 評価観点         │ 質問                                 │ 重み             │   │
│  ├──────────────────┼──────────────────────────────────────┼──────────────────┤   │
│  │ データ凝集度     │ 同じデータ（エンティティ）を操作？   │ 40%              │   │
│  │ 機能凝集度       │ 同じビジネス目標に貢献？             │ 30%              │   │
│  │ 時間凝集度       │ 同時に変更される可能性？             │ 20%              │   │
│  │ チーム境界       │ 同一チームが担当？                   │ 10%              │   │
│  └──────────────────┴──────────────────────────────────────┴──────────────────┘   │
│                                              Output: 凝集度スコア                 │
└───────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────────┐
│ Step 3: トランザクション境界分析                                                  │
├───────────────────────────────────────────────────────────────────────────────────┤
│  • 同一トランザクション内で完結すべきか？                                         │
│  • 結果整合性で許容できるか？                                                     │
│  • Saga/補償トランザクションが必要か？                                            │
│                                              Output: トランザクション境界         │
└───────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────────┐
│ Step 4: 対応パターン決定                                                          │
├───────────────────────────────────────────────────────────────────────────────────┤
│                                                                                   │
│                        ┌──────────────────────┐                                   │
│                        │   凝集度スコア判定   │                                   │
│                        └──────────┬───────────┘                                   │
│                                   │                                               │
│            ┌──────────────────────┼──────────────────────┐                        │
│            │                      │                      │                        │
│            ▼                      ▼                      ▼                        │
│   ┌────────────────┐    ┌────────────────┐    ┌────────────────┐                  │
│   │   スコア≧0.8  │    │ 0.5≦スコア<0.8│    │  スコア<0.5    │                  │
│   │   かつ高凝集   │    │   単一責務     │    │   複雑/大規模  │                  │
│   └───────┬────────┘    └───────┬────────┘    └───────┬────────┘                  │
│           │                     │                     │                          │
│           ▼                     ▼                     ▼                          │
│   ┌────────────────┐    ┌────────────────┐    ┌────────────────┐                  │
│   │   N:1 統合     │    │   1:1 対応     │    │   1:N 分割     │                  │
│   │ 複数CL3→1BC   │    │  1CL3→1BC     │    │  1CL3→複数BC  │                  │
│   └────────────────┘    └────────────────┘    └────────────────┘                  │
│                                                                                   │
│                                   Output: capability-bc-mapping.md                │
└───────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────────┐
│ Step 5: BC境界確定                                                                │
├───────────────────────────────────────────────────────────────────────────────────┤
│  成果物:                                                                          │
│  • BC名と責務                                                                     │
│  • 含まれるCL3一覧                                                                │
│  • Aggregate候補                                                                  │
│  • Domain Event候補                                                               │
│                                              Output: {bc-name}-boundary.md        │
└───────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
┌───────────────────────────────────────────────────────────────────────────────────┐
│ Step 6: Context Map作成                                                           │
├───────────────────────────────────────────────────────────────────────────────────┤
│  BC間関係パターン:                                                                │
│  ┌────────────────────┬────────────────────┬────────────────────┐                 │
│  │ Customer-Supplier  │ Partnership        │ Shared Kernel      │                 │
│  │ (上流/下流)        │ (対等連携)         │ (共有)             │                 │
│  ├────────────────────┼────────────────────┼────────────────────┤                 │
│  │ ACL                │ Published Language │ Open Host Service  │                 │
│  │ (変換層)           │ (公開言語)         │ (公開サービス)     │                 │
│  ├────────────────────┼────────────────────┼────────────────────┤                 │
│  │ Separate Ways      │ Conformist         │                    │                 │
│  │ (分離)             │ (準拠)             │                    │                 │
│  └────────────────────┴────────────────────┴────────────────────┘                 │
│                                              Output: context-map.md               │
└───────────────────────────────────────────────────────────────────────────────────┘
                                        │
                                        ▼
                    ┌──────────────────────────────────────┐
                    │   OUTPUT: BC定義群                   │
                    │   (Phase 4 成果物)                   │
                    │                                      │
                    │   • capability-bc-mapping.md         │
                    │   • {bc-name}-boundary.md            │
                    │   • context-map.md                   │
                    └──────────────────────────────────────┘
```

---

## 4. 具体例：発酵研究領域のCL3→BCマッピング

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│              具体例：飲料メーカー 発酵研究領域                                       │
│              Value Stream: VS2 製品開発・イノベーション                              │
└─────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────┐
│ Phase 3 Input: CL階層                                                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  CL1: 基盤技術研究 (Core傾向)                                                       │
│       │                                                                             │
│       ├── CL2: fermentation-research (Core, 投資優先度: 高)                         │
│       │        │                                                                    │
│       │        ├── CL3: OP-FER-001 酵母株探索・収集                                 │
│       │        │        Trigger: 新製品企画、品質改善要求                           │
│       │        │        Output:  候補酵母株リスト                                   │
│       │        │        Entity:  [YeastStrain, StrainSource]                        │
│       │        │                                                                    │
│       │        ├── CL3: OP-FER-002 酵母株育種・改良                                 │
│       │        │        Trigger: 目標特性決定                                       │
│       │        │        Output:  改良酵母株                                         │
│       │        │        Entity:  [YeastStrain, BreedingRecord]                      │
│       │        │                                                                    │
│       │        └── CL3: OP-FER-003 発酵条件最適化                                   │
│       │                 Trigger: 酵母株確定                                         │
│       │                 Output:  最適発酵条件                                       │
│       │                 Entity:  [FermentationCondition, OptimizationResult]        │
│       │                                                                             │
│       └── CL2: ingredient-research (Core, 投資優先度: 高)                           │
│                │                                                                    │
│                ├── CL3: OP-ING-001 素材評価・選定                                   │
│                │        Trigger: 製品コンセプト決定                                 │
│                │        Output:  素材評価レポート                                   │
│                │        Entity:  [Ingredient, EvaluationResult]                     │
│                │                                                                    │
│                └── CL3: OP-ING-002 配合設計                                         │
│                         Trigger: 素材確定                                           │
│                         Output:  配合レシピ                                         │
│                         Entity:  [Recipe, Ingredient]                               │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────────────┐
│ Phase 4: CL3 → BC 抽出プロセス                                                      │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  Step 1: 言語分析                                                                   │
│  ┌─────────────────────────────────┐    ┌─────────────────────────────────┐        │
│  │ グループA: 酵母株グループ       │    │ グループB: 素材グループ         │        │
│  │ 共通用語: 酵母株, 育種, 発酵    │    │ 共通用語: 素材, 配合, レシピ    │        │
│  │ CL3: FER-001, FER-002, FER-003  │    │ CL3: ING-001, ING-002           │        │
│  └─────────────────────────────────┘    └─────────────────────────────────┘        │
│                                                                                     │
│  Step 2: 凝集度評価                                                                 │
│  ┌─────────────────────────────────┐    ┌─────────────────────────────────┐        │
│  │ 発酵オペレーション群            │    │ 素材オペレーション群            │        │
│  │ データ凝集度:   高(YeastStrain) │    │ データ凝集度:   高(Ingredient)  │        │
│  │ 機能凝集度:     高(発酵技術向上)│    │ 機能凝集度:     高(素材最適化)  │        │
│  │ 時間凝集度:     高(同時に変更)  │    │ 時間凝集度:     高(同時に変更)  │        │
│  │ → 統合推奨 (スコア≧0.8)        │    │ → 統合推奨 (スコア≧0.8)        │        │
│  └─────────────────────────────────┘    └─────────────────────────────────┘        │
│                                                                                     │
│  Step 3: トランザクション境界                                                       │
│  ┌─────────────────────────────────────────────────────────────────────────┐       │
│  │ BC内 (強整合性):                                                        │       │
│  │   • 酵母株登録 → 育種記録 → 条件最適化                                  │       │
│  │   • 素材評価 → 配合設計                                                 │       │
│  │                                                                         │       │
│  │ BC間 (結果整合性OK):                                                    │       │
│  │   • 発酵BC → 素材BC                                                     │       │
│  └─────────────────────────────────────────────────────────────────────────┘       │
│                                                                                     │
│  Step 4: パターン決定                                                               │
│  ┌─────────────────────────────────┐    ┌─────────────────────────────────┐        │
│  │ CL3群: FER-001,002,003          │    │ CL3群: ING-001,002              │        │
│  │ パターン: N:1統合               │    │ パターン: N:1統合               │        │
│  │ 理由: 高凝集、同一ドメイン言語  │    │ 理由: 高凝集、同一ドメイン言語  │        │
│  └───────────────┬─────────────────┘    └───────────────┬─────────────────┘        │
│                  │                                       │                          │
│                  ▼                                       ▼                          │
│  ┌─────────────────────────────────┐    ┌─────────────────────────────────┐        │
│  │ fermentation-research-bc        │    │ ingredient-research-bc          │        │
│  └─────────────────────────────────┘    └─────────────────────────────────┘        │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────────────┐
│ Phase 4 Output: BC定義                                                              │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │ fermentation-research-bc                                                    │   │
│  │ 責務: 酵母株の探索・育種・発酵条件最適化                                    │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │ Aggregates:                                                                 │   │
│  │   ┌─────────────────────────────────┐  ┌─────────────────────────────────┐  │   │
│  │   │ YeastStrain (Root)              │  │ FermentationCondition (Root)    │  │   │
│  │   │   • BreedingRecord              │  │   • Temperature                 │  │   │
│  │   │   • StrainCharacteristics       │  │   • Duration                    │  │   │
│  │   │   • StrainCode (VO)             │  │   • pH (VO)                     │  │   │
│  │   │   • FermentationProfile (VO)    │  │                                 │  │   │
│  │   └─────────────────────────────────┘  └─────────────────────────────────┘  │   │
│  │ Domain Events:                                                              │   │
│  │   • YeastStrainRegistered                                                   │   │
│  │   • BreedingCompleted                                                       │   │
│  │   • OptimizationCompleted                                                   │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐   │
│  │ ingredient-research-bc                                                      │   │
│  │ 責務: 素材の評価・選定・配合設計                                            │   │
│  ├─────────────────────────────────────────────────────────────────────────────┤   │
│  │ Aggregates:                                                                 │   │
│  │   ┌─────────────────────────────────┐  ┌─────────────────────────────────┐  │   │
│  │   │ Ingredient (Root)               │  │ Recipe (Root)                   │  │   │
│  │   │   • EvaluationRecord            │  │   • RecipeVersion               │  │   │
│  │   │   • IngredientCode (VO)         │  │   • Proportion (VO)             │  │   │
│  │   │   • NutritionProfile (VO)       │  │   • ProcessingMethod (VO)       │  │   │
│  │   └─────────────────────────────────┘  └─────────────────────────────────┘  │   │
│  │ Domain Events:                                                              │   │
│  │   • IngredientEvaluated                                                     │   │
│  │   • RecipeDesigned                                                          │   │
│  └─────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────────────┐
│ Context Map                                                                         │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  ┌──────────────────────────┐                                                       │
│  │ fermentation-research-bc │                                                       │
│  │                          │                                                       │
│  │ [Upstream]               │                                                       │
│  └────────────┬─────────────┘                                                       │
│               │                                                                     │
│               │ Customer-Supplier                                                   │
│               │ Contract: FermentationProfileAPI                                    │
│               │ (発酵条件が素材配合に影響)                                          │
│               │                                                                     │
│               ▼                                                                     │
│  ┌──────────────────────────┐                                                       │
│  │ ingredient-research-bc   │                                                       │
│  │                          │                                                       │
│  │ [Downstream]             │                                                       │
│  └────────────┬─────────────┘                                                       │
│               │                                                                     │
│               │ Customer-Supplier                                                   │
│               │ Contract: RecipeAPI + RecipeDesignedEvent                           │
│               │ (配合レシピが製品開発の入力)                                        │
│               │                                                                     │
│               ▼                                                                     │
│  ┌──────────────────────────┐                                                       │
│  │ product-development-bc   │                                                       │
│  │                          │                                                       │
│  │ [Downstream]             │                                                       │
│  └──────────────────────────┘                                                       │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. CL3→BCマッピング サマリー図

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                        CL3 → BC マッピング サマリー                                  │
└─────────────────────────────────────────────────────────────────────────────────────┘

        CL3 業務オペレーション                              Bounded Context
   ┌────────────────────────────────┐                  ┌────────────────────────────┐
   │                                │                  │                            │
   │  ┌──────────────────────────┐  │                  │  ┌──────────────────────┐  │
   │  │ OP-FER-001               │  │                  │  │                      │  │
   │  │ 酵母株探索・収集         │──┼──┐               │  │ fermentation-        │  │
   │  └──────────────────────────┘  │  │               │  │ research-bc          │  │
   │                                │  │    N:1統合    │  │                      │  │
   │  ┌──────────────────────────┐  │  ├──────────────▶│  │ Aggregates:          │  │
   │  │ OP-FER-002               │  │  │               │  │  • YeastStrain       │  │
   │  │ 酵母株育種・改良         │──┼──┤               │  │  • Fermentation-     │  │
   │  └──────────────────────────┘  │  │               │  │    Condition         │  │
   │                                │  │               │  │                      │  │
   │  ┌──────────────────────────┐  │  │               │  └──────────────────────┘  │
   │  │ OP-FER-003               │──┼──┘               │                            │
   │  │ 発酵条件最適化           │  │                  │                            │
   │  └──────────────────────────┘  │                  │                            │
   │                                │                  │                            │
   │  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  │                  │  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─  │
   │                                │                  │                            │
   │  ┌──────────────────────────┐  │                  │  ┌──────────────────────┐  │
   │  │ OP-ING-001               │  │                  │  │                      │  │
   │  │ 素材評価・選定           │──┼──┐               │  │ ingredient-          │  │
   │  └──────────────────────────┘  │  │    N:1統合    │  │ research-bc          │  │
   │                                │  ├──────────────▶│  │                      │  │
   │  ┌──────────────────────────┐  │  │               │  │ Aggregates:          │  │
   │  │ OP-ING-002               │──┼──┘               │  │  • Ingredient        │  │
   │  │ 配合設計                 │  │                  │  │  • Recipe            │  │
   │  └──────────────────────────┘  │                  │  │                      │  │
   │                                │                  │  └──────────────────────┘  │
   │                                │                  │                            │
   └────────────────────────────────┘                  └────────────────────────────┘

        Problem Space (Phase 3)                          Solution Space (Phase 5)
```

---

## 6. アンチパターン

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              アンチパターン                                          │
└─────────────────────────────────────────────────────────────────────────────────────┘

  ❌ いきなりBC設計                    ❌ 1:1固定                    ❌ 巨大BC
  ┌───────────────────────┐          ┌───────────────────────┐    ┌───────────────────────┐
  │                       │          │                       │    │                       │
  │  CL3をスキップ        │          │  全CL3を1:1で         │    │  多くのCL3を         │
  │       ↓               │          │  BCにマッピング       │    │  1つのBCに統合       │
  │  BC設計を開始         │          │       ↓               │    │       ↓               │
  │       ↓               │          │  不必要に細かい       │    │  モノリス化          │
  │  ビジネス価値との     │          │  サービス分割         │    │  変更困難            │
  │  整合が取れない       │          │                       │    │                       │
  │                       │          │                       │    │                       │
  └───────────────────────┘          └───────────────────────┘    └───────────────────────┘

  ✅ 正しいアプローチ
  ┌───────────────────────────────────────────────────────────────────────────────────┐
  │                                                                                   │
  │  CL1 → CL2 → CL3 → 凝集度評価 → 適切なパターン選択 → BC定義                      │
  │                                                                                   │
  │  成功基準:                                                                        │
  │    • 各BCが単一責務を持つ                                                         │
  │    • BC間の依存が最小化されている                                                 │
  │    • チーム境界とBC境界が整合している                                             │
  │    • ユビキタス言語がBC内で一貫している                                           │
  │                                                                                   │
  └───────────────────────────────────────────────────────────────────────────────────┘
```

---

## 7. 凝集度評価マトリクス

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                          凝集度評価マトリクス                                        │
└─────────────────────────────────────────────────────────────────────────────────────┘

  ┌────────────────┬────────────────────────────┬────────────────────────────┬───────┐
  │ 評価観点       │ 高 (High)                  │ 低 (Low)                   │ 重み  │
  ├────────────────┼────────────────────────────┼────────────────────────────┼───────┤
  │                │                            │                            │       │
  │ データ凝集度   │ 同一Aggregateの            │ 独立した                   │ 40%   │
  │                │ データ操作                 │ データセット               │       │
  │                │                            │                            │       │
  ├────────────────┼────────────────────────────┼────────────────────────────┼───────┤
  │                │                            │                            │       │
  │ 機能凝集度     │ 単一ビジネス能力に         │ 複数の独立した             │ 30%   │
  │                │ 貢献                       │ 目標                       │       │
  │                │                            │                            │       │
  ├────────────────┼────────────────────────────┼────────────────────────────┼───────┤
  │                │                            │                            │       │
  │ 時間凝集度     │ 同じ理由で                 │ 独立して                   │ 20%   │
  │                │ 同時に変更                 │ 進化                       │       │
  │                │                            │                            │       │
  ├────────────────┼────────────────────────────┼────────────────────────────┼───────┤
  │                │                            │                            │       │
  │ チーム境界     │ 同一チームが               │ 独立した                   │ 10%   │
  │                │ 担当                       │ チーム                     │       │
  │                │                            │                            │       │
  └────────────────┴────────────────────────────┴────────────────────────────┴───────┘

  ┌─────────────────────────────────────────────────────────────────────────────────┐
  │ 判定ルール                                                                      │
  ├─────────────────────────────────────────────────────────────────────────────────┤
  │                                                                                 │
  │  総合スコア ≧ 0.8  ──────▶  N:1統合   「高凝集のCL3群を1つのBCに統合」         │
  │                                                                                 │
  │  0.5 ≦ スコア < 0.8  ────▶  1:1対応   「CL3とBCを1対1で対応」                  │
  │                                                                                 │
  │  スコア < 0.5 かつ複雑  ──▶  1:N分割   「1つのCL3を複数BCに分割」              │
  │                                                                                 │
  └─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 補足: キーポイント

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                               キーポイント                                           │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│  • CL3は問題領域の最下層（業務の詳細理解）                                          │
│                                                                                     │
│  • BCは解決領域の入口（技術境界の確定）                                             │
│                                                                                     │
│  • Phase 4がこの変換の責任を持つ                                                    │
│                                                                                     │
│  • 判断基準は凝集度が最重要                                                         │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
```
