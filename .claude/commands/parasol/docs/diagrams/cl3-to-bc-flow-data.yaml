# CL3â†’BCæŠ½å‡ºãƒ•ãƒ­ãƒ¼ ä½œå›³ç”¨ãƒ‡ãƒ¼ã‚¿
# Parasol V5 - å•é¡Œé ˜åŸŸã‹ã‚‰è§£æ±ºé ˜åŸŸã¸ã®ç§»è¡Œ

---
metadata:
  title: "Parasol V5 - å•é¡Œé ˜åŸŸã‹ã‚‰è§£æ±ºé ˜åŸŸã¸ã®ç§»è¡Œãƒ•ãƒ­ãƒ¼"
  version: "1.0"
  created: "2025-12-25"
  purpose: "CL3æ¥­å‹™ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰Bounded ContextæŠ½å‡ºã¾ã§ã®å…¨ä½“åƒã‚’å¯è¦–åŒ–"

---
# ============================================================
# 1. å…¨ä½“æ§‹é€ ï¼ˆ2æ®µéšZIGZAGãƒ¢ãƒ‡ãƒ«ï¼‰
# ============================================================

overall_structure:
  title: "2æ®µéšZIGZAGãƒ¢ãƒ‡ãƒ«"

  stage1:
    name: "ç¬¬1æ®µéš: ä¾¡å€¤ã®ZIGZAG"
    phase: "Phase 2"
    domain: "Value Domain"
    color: "#E8F5E9"  # è–„ç·‘
    flow:
      - step: "VL1"
        role: "WHAT"
        label: "æœ€ä¸Šä½ä¾¡å€¤"
        example: "æœŸå¾…ã‚’è¶…ãˆã‚‹ãŠã„ã—ã•"
      - step: "VL2"
        role: "HOW"
        label: "ä¾¡å€¤æ§‹é€ åŒ–"
        example: "è£½å“ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ä¾¡å€¤"
      - step: "VL3"
        role: "WHAT'"
        label: "æ§‹é€ åŒ–ä¾¡å€¤"
        example: "ç™ºé…µæŠ€è¡“ã«ã‚ˆã‚‹å‘³ã®é©æ–°"
      - step: "VMS"
        role: "HOW'"
        label: "ãƒã‚¤ãƒ«å®šç¾©"
        example: "VMS5â†’VMS1ãƒãƒƒã‚¯ã‚­ãƒ£ã‚¹ãƒˆ"
      - step: "VS"
        role: "WHAT''"
        label: "ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¸"
        example: "VS0-VS7ï¼ˆé¡§å®¢çŠ¶æ…‹ï¼‰"

  stage2:
    name: "ç¬¬2æ®µéš: ãƒ“ã‚¸ãƒã‚¹ã¨è¨­è¨ˆã®ZIGZAG"
    phase: "Phase 3-6"

    problem_space:
      name: "Problem Spaceï¼ˆå•é¡Œé ˜åŸŸï¼‰"
      phase: "Phase 3"
      color: "#E3F2FD"  # è–„é’
      description: "ä½•ã‚’è§£æ±ºã™ã‚‹ã‹ï¼ˆãƒ“ã‚¸ãƒã‚¹ç†è§£ï¼‰"
      responsibility: "æ¥­å‹™æ‹…å½“è€…ãƒ»ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ"
      flow:
        - step: "CL1"
          role: "WHAT"
          label: "æ´»å‹•é ˜åŸŸè­˜åˆ¥"
          classification: "å‚¾å‘çš„åˆ†é¡ï¼ˆå‚è€ƒæƒ…å ±ï¼‰"
          output: "activity-identification.md"
          responsible: "çµŒå–¶å±¤"
        - step: "CL2"
          role: "HOW"
          label: "ã‚±ã‚¤ãƒ‘ãƒ“ãƒªãƒ†ã‚£è¨­è¨ˆ"
          classification: "æ­£å¼åˆ†é¡ï¼ˆCore/Supporting/Genericï¼‰"
          output: "subdomain-design.md"
          responsible: "äº‹æ¥­éƒ¨é•·ãƒ»PO"
        - step: "CL3"
          role: "WHAT'"
          label: "æ¥­å‹™ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"
          classification: "åˆ†é¡ãªã—ï¼ˆç¶²ç¾…æ€§é‡è¦–ï¼‰"
          output: "{capability}-operations.md"
          responsible: "æ¥­å‹™æ‹…å½“è€…"

    transition:
      name: "å•é¡Œâ†’è§£æ±º å¤‰æ›"
      label: "DDDãƒãƒƒãƒ”ãƒ³ã‚°"
      phase: "Phase 4"
      color: "#FFF3E0"  # è–„ã‚ªãƒ¬ãƒ³ã‚¸
      description: "CL3ç¾¤ã‚’BCå¢ƒç•Œã«å¯¾å¿œä»˜ã‘"
      key_activity: "BCå¢ƒç•Œç¢ºå®š"
      output: "capability-bc-mapping.md"
      responsible: "ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ"

    solution_space:
      name: "Solution Spaceï¼ˆè§£æ±ºé ˜åŸŸï¼‰"
      phase: "Phase 5-6"
      color: "#F3E5F5"  # è–„ç´«
      description: "ã©ã†è§£æ±ºã™ã‚‹ã‹ï¼ˆæŠ€è¡“è¨­è¨ˆï¼‰"
      responsibility: "é–‹ç™ºãƒãƒ¼ãƒ "
      flow:
        - step: "BC"
          role: "WHAT"
          label: "å¢ƒç•Œä»˜ãã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ"
          output: "domain-language.md"
          responsible: "ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ"
        - step: "Service"
          role: "HOW"
          label: "ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆ"
          output: "service-definition.md"
          responsible: "é–‹ç™ºãƒªãƒ¼ãƒ‰"
        - step: "Implementation"
          role: "WHAT'"
          label: "å®Ÿè£…"
          output: "ã‚³ãƒ¼ãƒ‰"
          responsible: "é–‹ç™ºè€…"

---
# ============================================================
# 2. CL3â†’BCæŠ½å‡ºãƒ—ãƒ­ã‚»ã‚¹è©³ç´°
# ============================================================

cl3_to_bc_extraction:
  title: "CL3â†’BCæŠ½å‡ºãƒ—ãƒ­ã‚»ã‚¹"

  input:
    name: "CL3 æ¥­å‹™ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¾¤"
    source: "Phase 3cæˆæœç‰©"
    format: "{capability}-operations.md"
    example:
      - "OP-FER-001: é…µæ¯æ ªæ¢ç´¢ãƒ»åé›†"
      - "OP-FER-002: é…µæ¯æ ªè‚²ç¨®ãƒ»æ”¹è‰¯"
      - "OP-FER-003: ç™ºé…µæ¡ä»¶æœ€é©åŒ–"
      - "OP-ING-001: ç´ æè©•ä¾¡ãƒ»é¸å®š"
      - "OP-ING-002: é…åˆè¨­è¨ˆ"

  steps:
    - step_number: 1
      name: "ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªåˆ†æ"
      description: "åŒã˜ç”¨èªãƒ»æ¦‚å¿µã‚’ä½¿ç”¨ã™ã‚‹CL3ç¾¤ã‚’è­˜åˆ¥"
      criteria:
        - "åŒä¸€ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨èªã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹"
        - "åŒã˜ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’æ“ä½œã—ã¦ã„ã‚‹ã‹"
        - "å…±é€šã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚‹ã‹"
      output: "è¨€èªã‚°ãƒ«ãƒ¼ãƒ—"

    - step_number: 2
      name: "å‡é›†åº¦è©•ä¾¡"
      description: "CL3ç¾¤ã®é–¢é€£æ€§ã‚’3ã¤ã®è¦³ç‚¹ã§è©•ä¾¡"
      criteria:
        - name: "ãƒ‡ãƒ¼ã‚¿å‡é›†åº¦"
          question: "åŒã˜ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼‰ã‚’æ“ä½œã™ã‚‹ã‹ï¼Ÿ"
          high: "åŒä¸€Aggregateå†…ã®ãƒ‡ãƒ¼ã‚¿æ“ä½œ"
          low: "ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ"
        - name: "æ©Ÿèƒ½å‡é›†åº¦"
          question: "åŒã˜ãƒ“ã‚¸ãƒã‚¹ç›®æ¨™ã«è²¢çŒ®ã™ã‚‹ã‹ï¼Ÿ"
          high: "å˜ä¸€ã®ãƒ“ã‚¸ãƒã‚¹èƒ½åŠ›"
          low: "è¤‡æ•°ã®ç‹¬ç«‹ã—ãŸç›®æ¨™"
        - name: "æ™‚é–“å‡é›†åº¦"
          question: "åŒæ™‚ã«å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã‹ï¼Ÿ"
          high: "åŒã˜ç†ç”±ã§å¤‰æ›´"
          low: "ç‹¬ç«‹ã—ã¦é€²åŒ–"
      output: "å‡é›†åº¦ã‚¹ã‚³ã‚¢"

    - step_number: 3
      name: "ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œåˆ†æ"
      description: "å¼·æ•´åˆæ€§ãŒå¿…è¦ãªç¯„å›²ã‚’ç‰¹å®š"
      criteria:
        - "åŒä¸€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã§å®Œçµã™ã¹ãã‹"
        - "çµæœæ•´åˆæ€§ã§è¨±å®¹ã§ãã‚‹ã‹"
        - "Saga/è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã‹"
      output: "ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œ"

    - step_number: 4
      name: "å¯¾å¿œãƒ‘ã‚¿ãƒ¼ãƒ³æ±ºå®š"
      description: "åˆ†æçµæœã«åŸºã¥ãCL3â†’BCå¯¾å¿œã‚’æ±ºå®š"
      patterns:
        - pattern: "1:1"
          condition: "CL3ãŒå˜ä¸€è²¬å‹™ã§å®Œçµ"
          example: "fermentation-research â†’ fermentation-research-bc"
        - pattern: "N:1 çµ±åˆ"
          condition: "é«˜å‡é›†ã®CL3ç¾¤"
          example: "quality-control + quality-assurance â†’ quality-bc"
        - pattern: "1:N åˆ†å‰²"
          condition: "è¤‡é›‘ãƒ»å¤§è¦æ¨¡ãªCL3"
          example: "large-capability â†’ cap-a-bc + cap-b-bc"
      output: "capability-bc-mapping.md"

    - step_number: 5
      name: "BCå¢ƒç•Œç¢ºå®š"
      description: "æœ€çµ‚çš„ãªBCå®šç¾©ã‚’ä½œæˆ"
      deliverables:
        - "BCåã¨è²¬å‹™"
        - "å«ã¾ã‚Œã‚‹CL3ä¸€è¦§"
        - "Aggregateå€™è£œ"
        - "Domain Eventå€™è£œ"
      output: "{bc-name}-boundary.md"

    - step_number: 6
      name: "Context Mapä½œæˆ"
      description: "BCé–“ã®é–¢ä¿‚æ€§ã‚’å®šç¾©"
      patterns:
        - "Customer-Supplierï¼ˆä¸Šæµ/ä¸‹æµï¼‰"
        - "Partnershipï¼ˆå¯¾ç­‰é€£æºï¼‰"
        - "Shared Kernelï¼ˆå…±æœ‰ï¼‰"
        - "Anti-Corruption Layerï¼ˆå¤‰æ›å±¤ï¼‰"
        - "Published Languageï¼ˆå…¬é–‹è¨€èªï¼‰"
        - "Open Host Serviceï¼ˆå…¬é–‹ã‚µãƒ¼ãƒ“ã‚¹ï¼‰"
        - "Separate Waysï¼ˆåˆ†é›¢ï¼‰"
        - "Conformistï¼ˆæº–æ‹ ï¼‰"
      output: "context-map.md"

  output:
    name: "BCå®šç¾©ç¾¤"
    destination: "Phase 4æˆæœç‰©"
    files:
      - "capability-bc-mapping.md"
      - "{service}/bounded-contexts/{bc-name}-boundary.md"
      - "context-map.md"

---
# ============================================================
# 3. å…·ä½“ä¾‹ï¼šé£²æ–™ãƒ¡ãƒ¼ã‚«ãƒ¼ã®ç™ºé…µç ”ç©¶é ˜åŸŸ
# ============================================================

example:
  title: "å…·ä½“ä¾‹ï¼šç™ºé…µç ”ç©¶é ˜åŸŸã®CL3â†’BCæŠ½å‡º"
  company: "é£²æ–™ãƒ¡ãƒ¼ã‚«ãƒ¼"
  value_stream: "VS2: è£½å“é–‹ç™ºãƒ»ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³"

  phase3_input:
    cl1:
      name: "åŸºç›¤æŠ€è¡“ç ”ç©¶"
      classification: "Coreå‚¾å‘"

    cl2:
      - name: "fermentation-research"
        classification: "Core"
        investment_priority: "é«˜"
      - name: "ingredient-research"
        classification: "Core"
        investment_priority: "é«˜"

    cl3_operations:
      fermentation_research:
        - id: "OP-FER-001"
          name: "é…µæ¯æ ªæ¢ç´¢ãƒ»åé›†"
          trigger: "æ–°è£½å“ä¼ç”»ã€å“è³ªæ”¹å–„è¦æ±‚"
          output: "å€™è£œé…µæ¯æ ªãƒªã‚¹ãƒˆ"
          entities: ["YeastStrain", "StrainSource"]
        - id: "OP-FER-002"
          name: "é…µæ¯æ ªè‚²ç¨®ãƒ»æ”¹è‰¯"
          trigger: "ç›®æ¨™ç‰¹æ€§æ±ºå®š"
          output: "æ”¹è‰¯é…µæ¯æ ª"
          entities: ["YeastStrain", "BreedingRecord"]
        - id: "OP-FER-003"
          name: "ç™ºé…µæ¡ä»¶æœ€é©åŒ–"
          trigger: "é…µæ¯æ ªç¢ºå®š"
          output: "æœ€é©ç™ºé…µæ¡ä»¶"
          entities: ["FermentationCondition", "OptimizationResult"]

      ingredient_research:
        - id: "OP-ING-001"
          name: "ç´ æè©•ä¾¡ãƒ»é¸å®š"
          trigger: "è£½å“ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ±ºå®š"
          output: "ç´ æè©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ"
          entities: ["Ingredient", "EvaluationResult"]
        - id: "OP-ING-002"
          name: "é…åˆè¨­è¨ˆ"
          trigger: "ç´ æç¢ºå®š"
          output: "é…åˆãƒ¬ã‚·ãƒ”"
          entities: ["Recipe", "Ingredient"]

  phase4_extraction:
    step1_language_analysis:
      group_a:
        name: "é…µæ¯æ ªã‚°ãƒ«ãƒ¼ãƒ—"
        common_terms: ["é…µæ¯æ ª", "è‚²ç¨®", "ç™ºé…µ"]
        operations: ["OP-FER-001", "OP-FER-002", "OP-FER-003"]
      group_b:
        name: "ç´ æã‚°ãƒ«ãƒ¼ãƒ—"
        common_terms: ["ç´ æ", "é…åˆ", "ãƒ¬ã‚·ãƒ”"]
        operations: ["OP-ING-001", "OP-ING-002"]

    step2_cohesion_evaluation:
      fermentation_ops:
        data_cohesion: "é«˜ï¼ˆYeastStrainä¸­å¿ƒï¼‰"
        functional_cohesion: "é«˜ï¼ˆç™ºé…µæŠ€è¡“å‘ä¸Šï¼‰"
        temporal_cohesion: "é«˜ï¼ˆåŒæ™‚ã«å¤‰æ›´ï¼‰"
        result: "çµ±åˆæ¨å¥¨"
      ingredient_ops:
        data_cohesion: "é«˜ï¼ˆIngredientä¸­å¿ƒï¼‰"
        functional_cohesion: "é«˜ï¼ˆç´ ææœ€é©åŒ–ï¼‰"
        temporal_cohesion: "é«˜ï¼ˆåŒæ™‚ã«å¤‰æ›´ï¼‰"
        result: "çµ±åˆæ¨å¥¨"

    step3_transaction_boundary:
      within_bc:
        - "é…µæ¯æ ªç™»éŒ²â†’è‚²ç¨®è¨˜éŒ²â†’æ¡ä»¶æœ€é©åŒ–ï¼ˆå¼·æ•´åˆæ€§ï¼‰"
        - "ç´ æè©•ä¾¡â†’é…åˆè¨­è¨ˆï¼ˆå¼·æ•´åˆæ€§ï¼‰"
      across_bc:
        - "ç™ºé…µBCâ†’ç´ æBC: çµæœæ•´åˆæ€§ã§OK"

    step4_pattern_decision:
      - cl3_group: ["OP-FER-001", "OP-FER-002", "OP-FER-003"]
        pattern: "N:1çµ±åˆ"
        bc_name: "fermentation-research-bc"
        reason: "é«˜å‡é›†ã€åŒä¸€ãƒ‰ãƒ¡ã‚¤ãƒ³è¨€èª"
      - cl3_group: ["OP-ING-001", "OP-ING-002"]
        pattern: "N:1çµ±åˆ"
        bc_name: "ingredient-research-bc"
        reason: "é«˜å‡é›†ã€åŒä¸€ãƒ‰ãƒ¡ã‚¤ãƒ³è¨€èª"

    step5_bc_definition:
      - bc_name: "fermentation-research-bc"
        responsibility: "é…µæ¯æ ªã®æ¢ç´¢ãƒ»è‚²ç¨®ãƒ»ç™ºé…µæ¡ä»¶æœ€é©åŒ–"
        aggregates:
          - name: "YeastStrain"
            root: true
            entities: ["BreedingRecord", "StrainCharacteristics"]
            value_objects: ["StrainCode", "FermentationProfile"]
          - name: "FermentationCondition"
            root: true
            value_objects: ["Temperature", "Duration", "pH"]
        domain_events:
          - "YeastStrainRegistered"
          - "BreedingCompleted"
          - "OptimizationCompleted"

      - bc_name: "ingredient-research-bc"
        responsibility: "ç´ æã®è©•ä¾¡ãƒ»é¸å®šãƒ»é…åˆè¨­è¨ˆ"
        aggregates:
          - name: "Ingredient"
            root: true
            entities: ["EvaluationRecord"]
            value_objects: ["IngredientCode", "NutritionProfile"]
          - name: "Recipe"
            root: true
            entities: ["RecipeVersion"]
            value_objects: ["Proportion", "ProcessingMethod"]
        domain_events:
          - "IngredientEvaluated"
          - "RecipeDesigned"

    step6_context_map:
      relationships:
        - upstream: "fermentation-research-bc"
          downstream: "ingredient-research-bc"
          pattern: "Customer-Supplier"
          reason: "ç™ºé…µæ¡ä»¶ãŒç´ æé…åˆã«å½±éŸ¿"
          contract: "FermentationProfileAPI"
        - upstream: "ingredient-research-bc"
          downstream: "product-development-bc"
          pattern: "Customer-Supplier"
          reason: "é…åˆãƒ¬ã‚·ãƒ”ãŒè£½å“é–‹ç™ºã®å…¥åŠ›"
          contract: "RecipeAPI + RecipeDesignedEvent"

  phase5_output:
    service:
      name: "ResearchPlatformService"
      bounded_contexts:
        - "fermentation-research-bc"
        - "ingredient-research-bc"
      reason: "åŒä¸€ãƒãƒ¼ãƒ ãŒç®¡ç†ã€å¯†æ¥ãªé€£æº"

---
# ============================================================
# 4. åˆ¤æ–­åŸºæº–ãƒãƒˆãƒªã‚¯ã‚¹
# ============================================================

decision_matrix:
  title: "CL3â†’BCå¯¾å¿œãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤æ–­åŸºæº–"

  criteria:
    - name: "ãƒ‡ãƒ¼ã‚¿å‡é›†åº¦"
      weight: 0.4
      evaluation:
        high: "åŒä¸€Aggregateã®ãƒ‡ãƒ¼ã‚¿æ“ä½œ"
        medium: "é–¢é€£ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ‡ãƒ¼ã‚¿æ“ä½œ"
        low: "ç‹¬ç«‹ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ"

    - name: "æ©Ÿèƒ½å‡é›†åº¦"
      weight: 0.3
      evaluation:
        high: "å˜ä¸€ãƒ“ã‚¸ãƒã‚¹èƒ½åŠ›ã«è²¢çŒ®"
        medium: "é–¢é€£ã™ã‚‹è¤‡æ•°ã®èƒ½åŠ›"
        low: "ç‹¬ç«‹ã—ãŸèƒ½åŠ›"

    - name: "æ™‚é–“å‡é›†åº¦"
      weight: 0.2
      evaluation:
        high: "åŒã˜ç†ç”±ã§åŒæ™‚ã«å¤‰æ›´"
        medium: "ä¸€éƒ¨é‡è¤‡ã—ã¦å¤‰æ›´"
        low: "ç‹¬ç«‹ã—ã¦é€²åŒ–"

    - name: "ãƒãƒ¼ãƒ å¢ƒç•Œ"
      weight: 0.1
      evaluation:
        high: "åŒä¸€ãƒãƒ¼ãƒ ãŒæ‹…å½“"
        medium: "å¯†æ¥ã«å”åŠ›ã™ã‚‹ãƒãƒ¼ãƒ "
        low: "ç‹¬ç«‹ã—ãŸãƒãƒ¼ãƒ "

  decision_rules:
    - condition: "ç·åˆã‚¹ã‚³ã‚¢ >= 0.8"
      pattern: "N:1çµ±åˆ"
      description: "é«˜å‡é›†ã®CL3ç¾¤ã‚’1ã¤ã®BCã«çµ±åˆ"

    - condition: "0.5 <= ç·åˆã‚¹ã‚³ã‚¢ < 0.8"
      pattern: "1:1å¯¾å¿œ"
      description: "CL3ã¨BCã‚’1å¯¾1ã§å¯¾å¿œ"

    - condition: "ç·åˆã‚¹ã‚³ã‚¢ < 0.5 ã‹ã¤ CL3ãŒè¤‡é›‘"
      pattern: "1:Nåˆ†å‰²"
      description: "1ã¤ã®CL3ã‚’è¤‡æ•°BCã«åˆ†å‰²"

---
# ============================================================
# 5. å›³è§£ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæƒ…å ±
# ============================================================

layout:
  title: "ä½œå›³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæŒ‡å®š"

  main_diagram:
    name: "å•é¡Œé ˜åŸŸâ†’è§£æ±ºé ˜åŸŸãƒ•ãƒ­ãƒ¼å›³"
    orientation: "left-to-right"
    sections:
      - name: "Problem Space"
        position: "left"
        width: "40%"
        background: "#E3F2FD"
        elements:
          - "CL1 â†’ CL2 â†’ CL3"
          - "ç¸¦ã«3æ®µ"

      - name: "Transition"
        position: "center"
        width: "20%"
        background: "#FFF3E0"
        elements:
          - "BCå¢ƒç•Œç¢ºå®š"
          - "DDDãƒãƒƒãƒ”ãƒ³ã‚°"
          - "çŸ¢å°ï¼ˆå¤ªã‚ï¼‰"

      - name: "Solution Space"
        position: "right"
        width: "40%"
        background: "#F3E5F5"
        elements:
          - "BC â†’ Service â†’ å®Ÿè£…"
          - "ç¸¦ã«3æ®µ"

  detail_diagram:
    name: "CL3â†’BCæŠ½å‡ºã‚¹ãƒ†ãƒƒãƒ—å›³"
    orientation: "top-to-bottom"
    steps:
      - label: "Step 1"
        name: "è¨€èªåˆ†æ"
        shape: "rectangle"
        color: "#BBDEFB"
      - label: "Step 2"
        name: "å‡é›†åº¦è©•ä¾¡"
        shape: "rectangle"
        color: "#90CAF9"
      - label: "Step 3"
        name: "ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œ"
        shape: "rectangle"
        color: "#64B5F6"
      - label: "Step 4"
        name: "ãƒ‘ã‚¿ãƒ¼ãƒ³æ±ºå®š"
        shape: "diamond"
        color: "#42A5F5"
      - label: "Step 5"
        name: "BCå®šç¾©"
        shape: "rectangle"
        color: "#2196F3"
      - label: "Step 6"
        name: "Context Map"
        shape: "rectangle"
        color: "#1E88E5"

  example_diagram:
    name: "ç™ºé…µç ”ç©¶é ˜åŸŸã®ä¾‹"
    layout: "two-column"
    left_column:
      title: "CL3ï¼ˆå…¥åŠ›ï¼‰"
      items:
        - "OP-FER-001 é…µæ¯æ ªæ¢ç´¢"
        - "OP-FER-002 é…µæ¯æ ªè‚²ç¨®"
        - "OP-FER-003 ç™ºé…µæ¡ä»¶æœ€é©åŒ–"
        - "---"
        - "OP-ING-001 ç´ æè©•ä¾¡"
        - "OP-ING-002 é…åˆè¨­è¨ˆ"
    right_column:
      title: "BCï¼ˆå‡ºåŠ›ï¼‰"
      items:
        - "fermentation-research-bc"
        - "(YeastStrain, FermentationCondition)"
        - "---"
        - "ingredient-research-bc"
        - "(Ingredient, Recipe)"
    arrows:
      - from: ["OP-FER-001", "OP-FER-002", "OP-FER-003"]
        to: "fermentation-research-bc"
        label: "N:1çµ±åˆ"
      - from: ["OP-ING-001", "OP-ING-002"]
        to: "ingredient-research-bc"
        label: "N:1çµ±åˆ"

---
# ============================================================
# 6. Mermaidè¨˜æ³•ã‚µãƒ³ãƒ—ãƒ«
# ============================================================

mermaid_samples:

  overall_flow: |
    flowchart LR
      subgraph PS["Problem Space (Phase 3)"]
        direction TB
        CL1[CL1: æ´»å‹•é ˜åŸŸ]
        CL2[CL2: ã‚±ã‚¤ãƒ‘ãƒ“ãƒªãƒ†ã‚£]
        CL3[CL3: æ¥­å‹™ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³]
        CL1 --> CL2 --> CL3
      end

      subgraph TR["Transition (Phase 4)"]
        BC_MAP[BCå¢ƒç•Œç¢ºå®š<br/>DDDãƒãƒƒãƒ”ãƒ³ã‚°]
      end

      subgraph SS["Solution Space (Phase 5-6)"]
        direction TB
        BC[BC: å¢ƒç•ŒCtx]
        SVC[Serviceè¨­è¨ˆ]
        IMPL[å®Ÿè£…]
        BC --> SVC --> IMPL
      end

      PS --> TR --> SS

      style PS fill:#E3F2FD
      style TR fill:#FFF3E0
      style SS fill:#F3E5F5

  extraction_steps: |
    flowchart TB
      INPUT[CL3æ¥­å‹™ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¾¤]
      S1[Step1: ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªåˆ†æ]
      S2[Step2: å‡é›†åº¦è©•ä¾¡]
      S3[Step3: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œåˆ†æ]
      S4{Step4: ãƒ‘ã‚¿ãƒ¼ãƒ³æ±ºå®š}
      P1[1:1å¯¾å¿œ]
      P2[N:1çµ±åˆ]
      P3[1:Nåˆ†å‰²]
      S5[Step5: BCå®šç¾©ä½œæˆ]
      S6[Step6: Context Mapä½œæˆ]
      OUTPUT[BCå®šç¾©ç¾¤]

      INPUT --> S1 --> S2 --> S3 --> S4
      S4 -->|å˜ä¸€è²¬å‹™| P1
      S4 -->|é«˜å‡é›†| P2
      S4 -->|è¤‡é›‘ãƒ»å¤§è¦æ¨¡| P3
      P1 --> S5
      P2 --> S5
      P3 --> S5
      S5 --> S6 --> OUTPUT

  example_mapping: |
    flowchart LR
      subgraph CL3["CL3 æ¥­å‹™ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"]
        F1[OP-FER-001<br/>é…µæ¯æ ªæ¢ç´¢]
        F2[OP-FER-002<br/>é…µæ¯æ ªè‚²ç¨®]
        F3[OP-FER-003<br/>ç™ºé…µæ¡ä»¶æœ€é©åŒ–]
        I1[OP-ING-001<br/>ç´ æè©•ä¾¡]
        I2[OP-ING-002<br/>é…åˆè¨­è¨ˆ]
      end

      subgraph BC["Bounded Context"]
        FBC[fermentation-research-bc<br/>ğŸ§¬ YeastStrain<br/>âš—ï¸ FermentationCondition]
        IBC[ingredient-research-bc<br/>ğŸ¥¬ Ingredient<br/>ğŸ“‹ Recipe]
      end

      F1 --> FBC
      F2 --> FBC
      F3 --> FBC
      I1 --> IBC
      I2 --> IBC

      FBC -.->|Customer-Supplier| IBC

---
# ============================================================
# 7. è£œè¶³æƒ…å ±
# ============================================================

notes:
  key_points:
    - "CL3ã¯å•é¡Œé ˜åŸŸã®æœ€ä¸‹å±¤ï¼ˆæ¥­å‹™ã®è©³ç´°ç†è§£ï¼‰"
    - "BCã¯è§£æ±ºé ˜åŸŸã®å…¥å£ï¼ˆæŠ€è¡“å¢ƒç•Œã®ç¢ºå®šï¼‰"
    - "Phase 4ãŒã“ã®å¤‰æ›ã®è²¬ä»»ã‚’æŒã¤"
    - "åˆ¤æ–­åŸºæº–ã¯å‡é›†åº¦ãŒæœ€é‡è¦"

  anti_patterns:
    - name: "ã„ããªã‚ŠBCè¨­è¨ˆ"
      problem: "CL3ã‚’çµŒç”±ã›ãšã«BCè¨­è¨ˆã‚’å§‹ã‚ã‚‹"
      consequence: "ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã¨ã®æ•´åˆãŒå–ã‚Œãªã„"

    - name: "1:1å›ºå®š"
      problem: "å…¨ã¦ã®CL3ã‚’1:1ã§BCã«ãƒãƒƒãƒ”ãƒ³ã‚°"
      consequence: "ä¸å¿…è¦ã«ç´°ã‹ã„ã‚µãƒ¼ãƒ“ã‚¹åˆ†å‰²"

    - name: "å·¨å¤§BC"
      problem: "å¤šãã®CL3ã‚’1ã¤ã®BCã«çµ±åˆ"
      consequence: "ãƒ¢ãƒãƒªã‚¹åŒ–ã€å¤‰æ›´å›°é›£"

  success_criteria:
    - "å„BCãŒå˜ä¸€è²¬å‹™ã‚’æŒã¤"
    - "BCé–“ã®ä¾å­˜ãŒæœ€å°åŒ–ã•ã‚Œã¦ã„ã‚‹"
    - "ãƒãƒ¼ãƒ å¢ƒç•Œã¨BCå¢ƒç•ŒãŒæ•´åˆã—ã¦ã„ã‚‹"
    - "ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªãŒBCå†…ã§ä¸€è²«ã—ã¦ã„ã‚‹"
