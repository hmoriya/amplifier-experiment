---
description: Project context setup (project:parasol)
---

# Phase 1: Context - プロジェクト文脈確立

プロジェクトの基本的な文脈を確立します。このフェーズは1回のみ実行し、プロジェクト全体の基盤となります。

## 目的

- 組織の現状を理解する
- **業種・セグメント構造を特定する** ← Phase 2の前提条件
- 市場環境を評価する
- 制約事項を明確にする
- ステークホルダーを特定する

## ⚠️ 重要: 業種・セグメント認識

Phase 2（Value Definition）で適切なVSパターンを選択するため、このPhaseで業種とセグメント構造を特定します。

### セグメント構造の3パターン

| パターン | 説明 | 例 |
|----------|------|-----|
| **標準型** | 単一の顧客セグメント | 製造業、SaaS、小売 |
| **両面市場型** | 2つの異なる顧客が相互依存 | 人材派遣、不動産仲介 |
| **多面ステークホルダー型** | 3つ以上のセグメントが相互作用 | 地方銀行（個人/法人/行員） |

### コングロマリット判定チェック

> ⚠️ **重要**: コングロマリット（多角化企業）の場合、Phase 2で**事業部軸パターン**を優先する必要があります。

**コングロマリット判定基準**:
- [ ] 複数の独立した事業領域を持つか（例: 酒類 + 飲料 + 健康食品）
- [ ] 事業間の顧客基盤が異なるか（例: B2B + B2C混在）
- [ ] 事業間で独立したP/L管理がされているか
- [ ] M&Aや事業統合により複数企業が合併した歴史があるか

**2つ以上該当** → **コングロマリット型** → Phase 2で事業部軸パターン優先

```
⚠️ コングロマリット検出時の注意

シナジー ≠ VStr原則:
- 事業間シナジーはVStr統合の理由にならない
- 各事業は独立したVStrを持つ（事業部軸）
- シナジーはSupporting/Generic Layerで実現

詳細: _patterns/_axes/business-unit-axis.md（コングロマリット設計原則）
```

**参照**:
- 業種別パターン: `_patterns/industry-value-stream-patterns.md`
- 地銀詳細: `_patterns/regional-bank-value-streams.md`
- コングロマリット設計: `_patterns/_axes/business-unit-axis.md`



## 🔧 プロジェクト検出

**重要**: このコマンドはParasolプロジェクト内で実行する必要があります。

### 自動検出

コマンド実行時、以下の順序で `parasol.yaml` を自動探索：

1. **カレントディレクトリ** (`.`)
2. **親ディレクトリ** (`..`)
3. **祖父ディレクトリ** (`../..`)

### 検出成功

```
✅ プロジェクト検出: {project-name}

プロジェクトディレクトリ: projects/{project-name}/
出力先: projects/{project-name}/outputs/
```

プロジェクト設定を読み込み、Phase進捗を自動記録します。

### 検出失敗

```
❌ Parasolプロジェクトが見つかりません

📋 次のアクションを選択してください:

1. 新しいプロジェクトを作成
   → /parasol:project init {project-name}

2. 既存プロジェクトに移動
   → cd projects/{project-name}

3. プロジェクト一覧を確認
   → /parasol:project list
```

**ベストプラクティス**: プロジェクトディレクトリ内で作業
```bash
# 推奨
cd projects/my-project
/parasol:1-context

# 非推奨（プロジェクトが検出されない）
cd ~/somewhere-else
/parasol:1-context  # ❌
```

詳細は `.claude/commands/parasol/_project-detection.md` を参照。

## 🤖 Amplifierサブエージェント連携

Phase 1では以下のサブエージェントを活用して、コンテキスト分析を深化させます。

### 使用するサブエージェント

| サブエージェント | 用途 | 起動タイミング |
|-----------------|------|---------------|
| **concept-extractor** | 業界知識・概念の抽出 | 組織分析・市場評価時 |
| **content-researcher** | コンテンツファイルからの知見収集 | 既存資料がある場合 |
| **zen-architect** (ANALYZE) | 戦略的コンテキスト分析 | 組織・市場の構造分析 |

### concept-extractor の活用

組織情報や市場情報から、構造化された知識を抽出します：

```
Task tool を使用して concept-extractor を起動：

プロンプト:
「以下の組織・市場情報から、主要な概念と関係性を抽出してください。

入力:
- 企業名: {company_name}
- 業種: {industry}
- 市場環境: {market_context}

抽出対象:
1. 主要概念（ビジネスエンティティ、能力、プロセス）
2. 概念間の関係（is-a, has-a, depends-on）
3. 業界固有のドメイン用語
4. 競合との差別化ポイント

出力形式: SPO三つ組（Subject-Predicate-Object）のリスト」
```

### content-researcher の活用（既存資料がある場合）

プロジェクトに既存の資料（IR資料、事業計画など）がある場合：

```
Task tool を使用して content-researcher を起動：

プロンプト:
「以下のコンテンツファイルから、Phase 1コンテキスト分析に必要な
情報を抽出・整理してください。

対象ファイル: [ファイルパスリスト]

抽出項目:
1. 組織構造と主要事業
2. 市場ポジションと競合
3. 戦略的優先事項
4. 制約条件と課題

industry-segment-profile.md のセグメントパターン判定に
必要な情報を特に重点的に抽出してください。」
```

### ナレッジ蓄積（knowledge_synthesis連携）

抽出した概念をナレッジベースに蓄積し、将来のプロジェクトで再利用：

```python
# 概念の蓄積（将来の参照用）
outputs/1-context/extracted-concepts.json
{
  "project": "{project-name}",
  "industry": "{industry}",
  "concepts": [
    {"subject": "アサヒ", "predicate": "has-capability", "object": "発酵技術"},
    {"subject": "発酵技術", "predicate": "enables", "object": "製品差別化"}
  ],
  "domain_terms": ["醸造", "発酵", "プレミアムビール"],
  "extracted_at": "timestamp"
}
```

**参照**: 同業種の過去プロジェクトから類似概念を検索可能

---

## 成果物

以下のドキュメントを `outputs/1-context/` に作成します：

1. **organization-analysis.md** - 組織分析
2. **industry-segment-profile.md** - 業種・セグメント分析 ← **Phase 2必須入力**
3. **market-assessment.md** - 市場評価
4. **constraints.md** - 制約事項
5. **stakeholder-map.md** - ステークホルダーマップ
6. **extracted-concepts.json** - 抽出された概念（サブエージェント出力） ← **New**

## 実行手順

### ステップ1: 出力ディレクトリの確認と作成

`outputs/1-context/` ディレクトリの存在を確認し、存在しない場合は作成します。

### ステップ2: 既存成果物の確認

既に成果物が存在する場合、上書き確認を行います：

```
⚠️ Phase 1 の成果物が既に存在します：
✅ organization-analysis.md
✅ market-assessment.md
⏸️ constraints.md (未作成)
⏸️ stakeholder-map.md (未作成)

選択してください：
1. 不足している成果物のみ作成 (推奨)
2. 全て再作成（既存を上書き）
3. キャンセル
```

### ステップ3-7: 各成果物の作成

インタラクティブモードで情報を収集しながら、以下を順次作成：

1. **organization-analysis.md** - 組織の現状分析
2. **industry-segment-profile.md** - 業種・セグメント分析 **← 重要**
3. **market-assessment.md** - 市場環境評価
4. **constraints.md** - プロジェクト制約
5. **stakeholder-map.md** - ステークホルダー分析

各成果物の作成時、ユーザーと対話しながら情報を収集し、必要に応じてWeb検索で補完します。

**テンプレート参照**: `parasol-v5/templates/phase1/`

---

### industry-segment-profile.md テンプレート

```markdown
# 業種・セグメントプロファイル

## 1. 業種分類

### 主要業種
[以下から選択または複合]
- [ ] 製造業・消費財
- [ ] SaaS・ソフトウェア
- [ ] 金融サービス
- [ ] ヘルスケア・医療
- [ ] 小売・Eコマース
- [ ] プロフェッショナルサービス
- [ ] メディア・エンターテインメント
- [ ] 物流・運輸
- [ ] 地方銀行
- [ ] 人材派遣・人材サービス
- [ ] 不動産
- [ ] その他: [記述]

### 複合業種（該当する場合）
例: FinTech = 金融 + SaaS

---

## 2. セグメント構造

### パターン判定

**質問1**: 顧客は何種類いますか？
- [ ] 1種類 → 標準型
- [ ] 2種類（相互依存） → 両面市場型
- [ ] 3種類以上 → 多面ステークホルダー型

**質問2**: 顧客間に相互依存関係がありますか？
- 例: 「スタッフが増えるとクライアントが増える」
- 例: 「個人顧客の消費が法人顧客の売上になる」

**質問3**: 内部ステークホルダー（従業員等）はサービス品質に直接影響しますか？
- 例: 地方銀行の行員 → 顧客サービスに直結
- 例: 製造業の工場作業員 → 間接的影響

### 判定結果

**パターン**: [標準型 / 両面市場型 / 多面ステークホルダー型]

---

## 3. セグメント定義

### セグメント一覧

| ID | セグメント名 | 説明 | 主要ニーズ | 収益貢献 |
|----|--------------|------|------------|----------|
| A | [名称] | [対象者の説明] | [主要ニーズ] | [直接/間接] |
| B | [名称] | [対象者の説明] | [主要ニーズ] | [直接/間接] |
| C | [名称] | [対象者の説明] | [主要ニーズ] | [直接/間接] |

### セグメント間の関係

```
[関係図]
例（地方銀行）:
┌──────────┐         ┌──────────┐
│ 個人顧客 │◄───────►│ 法人顧客 │
└────┬─────┘         └────┬─────┘
     │    ┌────────┐      │
     └───►│  行員  │◄─────┘
          └────┬───┘
               │
               ▼
        ┌────────────┐
        │ 地域経済   │
        └────────────┘
```

### ネットワーク効果

| 起点 | 終点 | 効果 |
|------|------|------|
| [SegA]↑ | [SegB]↑ | [説明] |
| [SegB]↑ | [SegA]↑ | [説明] |

---

## 4. Phase 2への入力

### 推奨VSパターン

**パターン**: [標準型 / 両面市場型 / 多面ステークホルダー型]

**構成**:
- [ ] 標準型: 標準VSテンプレート × 8
- [ ] 両面市場型: 統合型VS（2面価値定義）
- [ ] 多面ステークホルダー型: Layer 1（分離型） + Layer 2（統合型）

### 参照パターン

`parasol/patterns/value/industry-value-stream-patterns.md` の [該当業種] を参照

---

## 5. 備考

### 業種固有の特徴
- [特徴1]
- [特徴2]

### 注意事項
- [注意点1]
- [注意点2]
```

## 完了条件

以下の5つの成果物が全て作成されたら完了：

- ✅ organization-analysis.md
- ✅ **industry-segment-profile.md** ← Phase 2必須
- ✅ market-assessment.md
- ✅ constraints.md
- ✅ stakeholder-map.md

## 完了メッセージ

```
✅ Phase 1: Context が完了しました

成果物:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ outputs/1-context/organization-analysis.md
✅ outputs/1-context/industry-segment-profile.md
✅ outputs/1-context/market-assessment.md
✅ outputs/1-context/constraints.md
✅ outputs/1-context/stakeholder-map.md

📊 業種・セグメント分析結果:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
業種: [検出された業種]
パターン: [標準型 / 両面市場型 / 多面ステークホルダー型]
セグメント: [セグメント一覧]

→ Phase 2で適用されるVSパターンが決定されました

📊 ステータス確認:
→ `/parasol:0-status`

🎯 次のステップ: Phase 2 Value Definition
→ `/parasol:2-value`

💡 ヒント:
Phase 1 は反復不要です。内容を更新する場合は、
成果物ファイルを直接編集してください。
業種・セグメント変更時はPhase 2も再実行してください。
```

## エラーハンドリング

### エラー1: 出力ディレクトリ作成失敗

```
❌ 出力ディレクトリの作成に失敗しました

パス: outputs/1-context/
エラー: [詳細なエラーメッセージ]

対処方法:
1. ディレクトリの権限を確認
2. 手動でディレクトリを作成
3. 再度コマンドを実行
```

### エラー2: Web検索失敗

```
⚠️ Web検索に失敗しました

手動で情報を入力しますか？ (y/n):
> y

[インタラクティブモードに切り替え]
```

## バリデーション

作成後、以下を自動チェック：

1. **ファイル存在確認**: 4つの成果物が全て存在するか
2. **内容確認**: 各ファイルが空でないか、最小限のセクションを含むか
3. **整合性確認**: 組織名などの基本情報が一貫しているか

問題がある場合：

```
⚠️ バリデーション警告

- constraints.md が空です
- organization-analysis.md に "組織概要" セクションがありません

修正して再度確認しますか？
→ `/parasol:validate phase1`
```

## 参考資料

- **フレームワーク設計**: `parasol-v5/FRAMEWORK-DESIGN.md`
- **テンプレート**: `parasol-v5/templates/phase1/`
