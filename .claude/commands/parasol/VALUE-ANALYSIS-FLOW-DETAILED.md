# Parasol V5 価値分析フロー詳細版
## 価値駆動の分析から実装への体系的プロセス

---

## 🎯 価値分解プロセス全体像

価値定義からバリューストリーム設計までの3ステップを示します。

```
┌─────────────────────────────────────────────────────────────────────────────┐
│           最重要分解1: 価値定義 → バリューストリーム設計                    │
│                     （Phase 1-2: ビジネス価値の構造化）                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  【STEP 1: 価値分解 - 顧客価値の階層化】                                    │
│                                                                             │
│      VL1（最上位価値）                                                      │
│       │  例: 「顧客の健康に貢献する」                                       │
│       │                                                                     │
│       ├─→ VL2（価値グループ）                                              │
│       │    │  例: 「身体的健康」「精神的健康」「社会的健康」                │
│       │    │                                                                │
│       │    └─→ VL3（詳細価値）                                             │
│       │         例: 「機能性食品による栄養補給」                            │
│       │         例: 「健康情報による予防意識向上」                          │
│       │         ※ 実行可能な粒度まで分解                                   │
│       │                                                                     │
│       │                                                                     │
│  【STEP 2: 価値マイルストーン導出 - バックキャスト】                        │
│                                                                             │
│       │         ┌────────────────────────────────────────┐                 │
│       │         │ VMS5「期待を超える価値を享受」← 起点   │                 │
│       │         │   ↑                                   │                 │
│       │         │ VMS4「全面的に価値を実感」            │                 │
│       │         │   ↑                                   │                 │
│       │         │ VMS3「主要価値を日常的に体験」        │                 │
│       │         │   ↑                                   │                 │
│       │         │ VMS2「価値を認識し選択できる」        │                 │
│       │         │   ↑                                   │                 │
│       │         │ VMS1「最初の価値を体験」              │                 │
│       │         │                                       │                 │
│       │         │ ※ 主語は「顧客」、内容は「状態」     │                 │
│       │         └────────────────────────────────────────┘                 │
│       │                                                                     │
│       │                                                                     │
│  【STEP 3: バリューストリーム設計 - 顧客状態遷移】                          │
│                                                                             │
│       └─→ VS0 → VS1 → VS2 → VS3 → VS4 → VS5 → VS6 → VS7                    │
│           潜在   認知   選好   決定   獲得   実感   継続   共創              │
│            │      │      │      │      │      │      │      │              │
│            ▼      ▼      ▼      ▼      ▼      ▼      ▼      ▼              │
│          ┌──────────────────────────────────────────────────┐              │
│          │  各VSに貢献するVL3（詳細価値）をマッピング       │              │
│          │  → VL×VSマトリクス完成                           │              │
│          └──────────────────────────────────────────────────┘              │
│                                                                             │
│  【出力】                                                                   │
│  ├─ VL1-VL2-VL3階層（価値構造）                                            │
│  ├─ VMS1-VMS5（顧客価値状態マイルストーン）                                │
│  ├─ VS0-VS7（バリューストリーム定義）                                      │
│  └─ VL×VSマッピング（価値×ステージ対応表）                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 設計フローの要約

| STEP | 名称 | 内容 | 方向 |
|------|------|------|------|
| 1 | VL分解 | VL1→VL2→VL3へ階層分解 | トップダウン |
| 2 | VMSバックキャスト | VMS5（理想）からVMS1へ逆算 | ボトムアップ |
| 3 | VS設計 | VS0〜VS7の顧客状態遷移定義 | 時系列 |

---

## 🔍 抽象度の変化を理解する

### 抽象度の流れ（V字型）

```
抽象度
  高
   ↑
   │  Phase 1: 企業価値（VL1-3）
   │      ↓
   │  Phase 2: Value Stream（VS）
   │      ↓
   │  Phase 3: ビジネス能力分解
   │      ├─ CL1: 活動領域（高）← 傾向的分類
   │      ├─ CL2: ケイパビリティ（中）← 正式分類
   │      └─ CL3（≈BizOp）（低）← 最も具体的・分類なし
   │                    
   │  ========= 視点の切り替え =========
   │                    
   │  Phase 4: アプリケーションアーキテクチャ
   │      ├─ BC（Bounded Context）（中）← 抽象度が戻る
   │      ├─ Context Map（高）
   │      └─ マイクロサービス（中）
   │                    
   │  Phase 5-6: ソフトウェア設計
   │      ├─ ユースケース（低）← 再び具体化
   │      ├─ 画面/API（最低）
   │      └─ 実装詳細
   ↓
  低
```

**重要**: CL3（最も具体的）→ BC（抽象度が戻る）→ ユースケース（再び具体化）

---

## 📊 Phase 3 → Phase 4 の抽象度変化

### なぜ抽象度が戻るのか？

```
Phase 3: ビジネス視点での最大詳細化
┌─────────────────────────────────┐
│ CL3: ビジネスオペレーション      │
│ - 登録審査プロセス（詳細手順）    │
│ - 面談実施フロー（詳細手順）      │
│ - スキル評価手順（詳細手順）      │
└─────────────────────────────────┘
         ↓ 技術視点への変換
         ↓ 複数のCL3を束ねる
         
Phase 4: 技術視点での境界定義
┌─────────────────────────────────┐
│ BC: 人材管理コンテキスト         │
│ - 複数のビジネスオペレーション   │
│ - 統一されたデータモデル         │
│ - 技術的な凝集性で再グループ化   │
└─────────────────────────────────┘
```

**理由**: 
1. 技術的な整合性を保つため複数のCL3を統合
2. データの一貫性を保証する境界を定義
3. チーム単位・デプロイ単位を考慮

---

## 🔄 BC内でのユースケース分解

### BC → ユースケース → 実装

```
BC: スキル評価コンテキスト
│
├─ 集約: SkillAssessment
│   │
│   ├─ ユースケース1: スキル診断を開始する
│   │   ├─ アクター: 評価対象者、評価管理者
│   │   ├─ 事前条件: 評価対象者が登録済み
│   │   ├─ 基本フロー: 
│   │   │   1. 評価タイプを選択
│   │   │   2. 評価を開始
│   │   │   3. 評価IDを発行
│   │   └─ 事後条件: 評価が「実施中」状態
│   │
│   ├─ ユースケース2: 評価結果を提出する
│   │   ├─ アクター: 評価対象者
│   │   ├─ 事前条件: 評価が「実施中」状態
│   │   ├─ 基本フロー:
│   │   │   1. 回答を入力
│   │   │   2. 検証を実行
│   │   │   3. 結果を保存
│   │   └─ 事後条件: 評価が「完了」状態
│   │
│   └─ ユースケース3: スキルレポートを生成する
│       ├─ アクター: 評価管理者、評価対象者
│       ├─ 事前条件: 評価が「完了」状態
│       └─ 基本フロー: レポート生成ロジック
│
└─ 集約: SkillPortfolio
    │
    ├─ ユースケース4: ポートフォリオを更新する
    └─ ユースケース5: スキル履歴を参照する
```

---

## 📈 抽象度レベル別の成果物

### Phase別成果物と抽象度

| Phase | 抽象度 | 成果物 | 内容の具体性 |
|-------|--------|--------|--------------|
| 1 | 最高 | VL1-3 | 「人材価値の最大化」（概念） |
| 2 | 高 | Value Stream | 「スキル開発の流れ」（プロセス） |
| 3 | 高→低 | CL1→CL2→CL3 | 「評価実施手順」（詳細業務） |
| 4 | 中 | BC/Context Map | 「評価コンテキスト」（技術境界） |
| 5 | 低 | ユースケース | 「診断を開始する」（具体操作） |
| 6 | 最低 | 画面/API/Code | 実装コード |

---

## 🎯 ビジネス分解 vs 技術分解の違い

### Phase 3: ビジネス能力の分解（CL1→CL2→CL3）

```
CL1: スキル開発活動領域（傾向的分類 - 参考情報）
    ↓
CL2: スキル評価ケイパビリティ（正式分類 - 投資判断）
    ↓
CL3: 評価実施オペレーション（詳細化 - 網羅性重視）
    - 評価申込受付
    - 評価問題配信
    - 回答収集
    - 採点処理
    - 結果通知
```

### Phase 4-5: 技術境界での再構成（BC→ユースケース）

```
BC: スキル評価コンテキスト（技術的にまとまる単位）
    ├─ CL3: 評価実施オペレーション ←┐
    ├─ CL3: 評価管理オペレーション ←┤ 複数のCL3を
    └─ CL3: 評価分析オペレーション ←┘ 技術観点で統合
    
    ↓ BC内で詳細化
    
    ユースケース（誰が何をするか）
    ├─ UC1: 評価を申し込む（応募者）
    ├─ UC2: 評価を承認する（管理者）
    ├─ UC3: 評価を受験する（応募者）
    └─ UC4: 結果を確認する（応募者/管理者）
```

---

## 🔄 実例：Staff Holdings のケース

### CL3からBCへの変換例

```
Phase 3 で定義したCL3:
1. vs2-skill-assessment/スキル診断実施
2. vs2-skill-assessment/スキルギャップ分析  
3. vs2-skill-assessment/ポートフォリオ管理
4. vs2-skill-assessment/市場価値算定

↓ 技術視点で再編成

Phase 4 で定義するBC:
BC: SkillAssessmentContext
├─ 含まれるCL3: 1,2,3,4（データ的に密結合）
├─ 集約:
│   ├─ SkillAssessment（診断と分析）
│   └─ SkillPortfolio（ポートフォリオと価値）
└─ ユースケース:
    ├─ 診断系
    │   ├─ UC1: オンライン診断を受ける
    │   ├─ UC2: 360度評価を依頼する
    │   └─ UC3: 実技テストを予約する
    ├─ 分析系
    │   ├─ UC4: ギャップレポートを生成する
    │   └─ UC5: 市場価値を算出する
    └─ 管理系
        ├─ UC6: ポートフォリオを更新する
        └─ UC7: スキル証明を発行する
```

---

## 📊 ユースケース詳細の定義

### BC内でのユースケース定義テンプレート

```yaml
BC: SkillAssessmentContext
  UseCase: オンライン診断を受ける
    ID: UC-SA-001
    
    アクター:
      主アクター: 評価対象者（スタッフ）
      副アクター: 評価システム
      
    事前条件:
      - 評価対象者がシステムに登録済み
      - 診断の実施権限を持っている
      
    基本フロー:
      1. 評価対象者が診断メニューにアクセス
      2. システムが利用可能な診断を表示
      3. 評価対象者が診断を選択
      4. システムが診断を開始
      5. 評価対象者が問題に回答
      6. システムが回答を検証・保存
      7. システムが結果を算出
      8. システムが結果を表示
      
    代替フロー:
      4a. 診断が一時中断された場合
          1. システムが進捗を保存
          2. 後で再開可能
          
    例外フロー:
      6a. 不正な回答パターンを検出
          1. システムが警告を表示
          2. 管理者に通知
          
    事後条件:
      - 診断結果が保存されている
      - ポートフォリオが更新されている
```

---

## 🎨 視点による同一対象の見え方の違い

### 「スキル評価」を異なる視点で見る

```
ビジネス視点（Phase 3）:
┌─────────────────────────┐
│ スキル評価能力          │
│ - 業務プロセス          │
│ - ビジネスルール        │
│ - 業務用語              │
└─────────────────────────┘

技術視点（Phase 4）:
┌─────────────────────────┐
│ 評価管理システム        │
│ - データモデル          │
│ - API設計               │
│ - トランザクション      │
└─────────────────────────┘

運用視点（Phase 5-6）:
┌─────────────────────────┐
│ 評価サービス            │
│ - デプロイ単位          │
│ - スケーリング          │
│ - 監視ポイント          │
└─────────────────────────┘
```

---

## 📋 まとめ：抽象度の管理ポイント

### 1. V字型の抽象度変化を理解する
- Phase 1-3: 抽象→具体（ビジネス分解）
- Phase 4: 具体→抽象（技術統合）  
- Phase 5-6: 抽象→具体（実装詳細化）

### 2. 視点切り替えでの再構成を受け入れる
- CL3の詳細な業務定義
- BCでの技術的な再グループ化
- ユースケースでの再詳細化

### 3. 各レベルでの適切な粒度を保つ
- ビジネス: 業務の自然な単位
- 技術: データとトランザクションの一貫性
- 実装: 画面とAPIの操作単位

**この抽象度の管理により、ビジネス要求から実装まで、価値を損なうことなく体系的に変換できます**

---

## 🔄 ZIGZAGプロセスとの連携

### ZIGZAGプロセスの本質

Parasol V5は「価値駆動ZIGZAGプロセス」を採用しています（詳細は`_zigzag-process.md`参照）：

```
┌─────────────────────────────────────────────────────────┐
│ ZIGZAG = 視座転換による創発的分解                       │
│                                                        │
│ WHATの抽象語彙空間で行き詰まった時、                    │
│ HOWの具体語彙空間への強制転換により、                   │
│ 元のWHATに暗黙に含まれていた未言語化概念が顕在化する。  │
└─────────────────────────────────────────────────────────┘
```

### 2段階ZIGZAGパターン

```
【第1段階】価値のZIGZAG
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 VL1(WHAT): 最上位価値
  ↓ 行き詰まったらHOWへ
 VL2(HOW): 価値構造化
  ↓ 新しいWHATが見える
 VL3(WHAT'): 構造化価値
  ↓ 行き詰まったらHOWへ
 VMS(HOW'): マイル定義
  ↓ 新しいWHATが見える
 VS(WHAT''): マイル成果

【第2段階】ビジネスと設計のZIGZAG
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
┌ Problem Space（問題領域）
│ CL1(WHAT): 活動領域
│  ↓ 行き詰まったらHOWへ
│ CL2(HOW): ドメイン分類
│  ↓ 新しいWHATが見える
│ CL3(WHAT'): 業務オペレーション
└────────────────────────
  ↓ DDDマッピング
┌ Solution Space（解決領域）
│ BC(WHAT): 境界付きコンテキスト
│  ↓ 行き詰まったらHOWへ
│ Service(HOW): サービス設計
│  ↓ 新しいWHATが見える
│ 実装(WHAT'): コード
└────────────────────────
```

### 「詰まり」の検知と突破

**詰まりのシグナル**:
1. 同じ単語が3回以上繰り返される
2. 「つまり」で言い換えても新情報がない
3. 抽象度が変わらない（上にも下にも行けない）

**突破方法**:
```
詰まり検知
  ↓
「これをどう実装/実現するか？」と強制的に問う
  ↓
具体的な手段・技術・活動を列挙
  ↓
各HOWから見えてくる新しいWHATを言語化
```

### V字型抽象度変化との関係

ZIGZAGプロセスは、V字型の抽象度変化と密接に関連：

- **Phase 1-3**: WHAT→HOWの繰り返しで徐々に具体化
- **Phase 4**: 視点転換（ビジネス→技術）でWHATが再抽象化  
- **Phase 5-6**: 技術視点でのWHAT→HOWで再具体化

### 実例：スキル評価での創発

```
WHAT: 「スキル評価機能」（抽象、これ以上分解困難）
  ↓ どう実現する？
HOW: 「オンライン診断」「360度評価」「実技テスト」
  ↓ 各HOWから新WHATが創発
WHAT': 「評価信頼性保証」「不正防止」「評価履歴管理」
       （元のWHATには明示されていなかった要件）
```

この創発により、CL3では想定していなかった要件がBC設計時に顕在化します。