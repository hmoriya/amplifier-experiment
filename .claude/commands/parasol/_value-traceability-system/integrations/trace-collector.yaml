# Parasol Trace Collector - トレースデータ収集システム
# Phase実行中のリアルタイムデータ収集と価値関連情報の自動抽出

name: "Parasol Trace Collector"
version: "1.0.0"
description: "価値トレーサビリティのためのリアルタイムデータ収集・処理システム"

# ===== 収集設定 =====
collection_config:
  real_time_capture:
    enabled: true
    capture_frequency: "immediate"     # 即座にキャプチャ
    buffer_size: 1000                  # バッファサイズ
    flush_interval: 30                 # 秒単位
    
  data_enrichment:
    automatic_enrichment: true
    context_inference: true            # コンテキスト推論
    relationship_detection: true       # 関係性検出
    metadata_generation: true          # メタデータ生成
    
  storage_strategy:
    primary_storage: "structured_json"
    backup_storage: "raw_logs"
    compression: true
    encryption: true

# ===== 収集対象データ =====
data_sources:
  command_execution:
    input_parameters:
      capture: true
      sanitization: "remove_sensitive_data"
      validation: "schema_compliance"
      
    execution_context:
      timestamp: "iso_8601"
      executor: "user_identity"
      environment: "system_state"
      project_state: "current_status"
      
    output_artifacts:
      generated_files: "content_checksum"
      decisions_made: "full_capture"
      recommendations: "structured_format"
      
  user_interactions:
    input_responses:
      capture: "user_provided_inputs"
      classification: "automatic_categorization"
      quality_assessment: "immediate"
      
    decision_rationale:
      capture: "reasoning_process"
      evidence_links: "source_tracking"
      confidence_level: "user_assessment"
      
  system_events:
    phase_transitions:
      timing: "precise_timestamps"
      state_changes: "before_after_comparison"
      triggers: "event_causality"
      
    validation_results:
      necessity_scores: "detailed_breakdown"
      gate_outcomes: "comprehensive_results"
      quality_metrics: "performance_tracking"

# ===== データ分類・抽出 =====
data_classification:
  value_related_data:
    categories:
      - value_hierarchy_references
      - business_objectives
      - customer_impact_statements
      - roi_calculations
      
    extraction_patterns:
      vl_references: "regex: VL[1-3]: .+"
      value_keywords: ["価値", "ビジネス", "顧客", "ROI", "効果"]
      impact_statements: "pattern: .*によって.*を実現"
      
  decision_data:
    categories:
      - design_choices
      - technology_selections  
      - architecture_decisions
      - process_definitions
      
    extraction_patterns:
      decision_keywords: ["決定", "選択", "採用", "実装"]
      rationale_patterns: "pattern: .*のため.*を選択"
      alternative_mentions: "pattern: .*より.*を優先"
      
  evidence_data:
    categories:
      - market_analysis
      - technical_research
      - competitive_intelligence
      - user_feedback
      
    extraction_patterns:
      evidence_keywords: ["調査", "分析", "データ", "事実"]
      source_patterns: "pattern: .*によると"
      quantitative_data: "regex: \d+\.?\d*[%円$€]"

# ===== リアルタイム処理 =====
real_time_processing:
  stream_processing:
    pipeline_stages:
      1. raw_data_ingestion
      2. data_normalization  
      3. context_enrichment
      4. relationship_mapping
      5. quality_assessment
      6. storage_routing
      
    processing_speed: "< 100ms per record"
    throughput: "> 1000 records/second"
    
  intelligent_extraction:
    natural_language_processing:
      - intent_recognition
      - entity_extraction
      - sentiment_analysis
      - relationship_identification
      
    pattern_recognition:
      - value_chain_patterns
      - decision_tree_patterns
      - causality_patterns
      - quality_patterns
      
    machine_learning:
      - classification_models
      - prediction_models
      - anomaly_detection
      - trend_analysis

# ===== 品質保証 =====
quality_assurance:
  data_validation:
    completeness_check:
      - required_fields_presence
      - data_structure_integrity
      - reference_consistency
      
    accuracy_verification:
      - format_compliance
      - value_range_validation
      - logical_consistency
      
    freshness_monitoring:
      - timestamp_validation
      - staleness_detection
      - update_frequency_tracking
      
  anomaly_detection:
    statistical_analysis:
      - outlier_detection
      - pattern_deviation
      - trend_anomalies
      
    behavioral_analysis:
      - unusual_decision_patterns
      - inconsistent_reasoning
      - value_drift_detection
      
    quality_degradation:
      - evidence_quality_decline
      - trace_completeness_reduction
      - relationship_weakening

# ===== Phase別収集戦略 =====
phase_specific_collection:
  phase_0_init:
    priority_data:
      - company_url_analysis
      - initial_value_hypotheses
      - stakeholder_identification
      
    collection_focus:
      - foundational_assumptions
      - initial_context_capture
      - project_initialization_decisions
      
    quality_criteria:
      - assumption_clarity
      - context_completeness
      - stakeholder_coverage
      
  phase_1_context:
    priority_data:
      - stakeholder_analysis_results
      - constraint_identification
      - context_model_development
      
    collection_focus:
      - stakeholder_categorization_logic
      - constraint_prioritization_rationale
      - context_boundary_definitions
      
    quality_criteria:
      - stakeholder_coverage_completeness
      - constraint_analysis_depth
      - context_model_coherence
      
  phase_2_value:
    priority_data:
      - value_hierarchy_construction
      - backcast_reasoning_process
      - milestone_definition_logic
      
    collection_focus:
      - value_decomposition_decisions
      - backcast_step_rationale
      - milestone_achievement_criteria
      
    quality_criteria:
      - value_hierarchy_logic
      - backcast_reasoning_soundness
      - milestone_measurability
      
  phase_3_capabilities:
    priority_data:
      - domain_classification_logic
      - capability_decomposition_process
      - bounded_context_definition
      
    collection_focus:
      - cl1_classification_rationale
      - cl2_decomposition_decisions
      - cl3_context_boundary_logic
      
    quality_criteria:
      - domain_classification_consistency
      - decomposition_completeness
      - context_boundary_clarity
      
  phase_4_to_7:
    priority_data:
      - technical_decision_rationale
      - implementation_choice_logic
      - quality_standard_compliance
      
    collection_focus:
      - architecture_decision_records
      - implementation_strategy_choices
      - quality_assurance_evidence
      
    quality_criteria:
      - technical_decision_soundness
      - implementation_feasibility
      - quality_standard_achievement

# ===== 関係性マッピング =====
relationship_mapping:
  value_chain_tracking:
    vl_hierarchy_relationships:
      - vl1_to_vl2_decomposition
      - vl2_to_vl3_refinement
      - vl3_to_capability_mapping
      
    causality_chains:
      - decision_to_outcome
      - requirement_to_implementation
      - constraint_to_design_choice
      
  temporal_relationships:
    sequence_tracking:
      - decision_order
      - dependency_chains
      - milestone_progression
      
    evolution_tracking:
      - requirement_evolution
      - design_refinement
      - value_realization_progress
      
  cross_phase_connections:
    artifact_lineage:
      - concept_to_implementation
      - requirement_to_test
      - design_to_code
      
    decision_impact:
      - early_decision_consequences
      - change_propagation
      - risk_materialization

# ===== データ出力・配信 =====
data_distribution:
  real_time_feeds:
    value_tracer_feed:
      format: "structured_json"
      frequency: "immediate"
      content: "trace_records"
      
    necessity_judge_feed:
      format: "evaluation_input"
      frequency: "on_decision"
      content: "decision_context"
      
    assurance_gate_feed:
      format: "gate_input"
      frequency: "on_milestone"
      content: "achievement_data"
      
  batch_exports:
    daily_summary:
      format: "aggregated_json"
      content: "daily_collection_summary"
      
    weekly_analysis:
      format: "analytical_report"
      content: "trend_analysis_and_insights"
      
    milestone_package:
      format: "comprehensive_archive"
      content: "complete_milestone_data"

# ===== パフォーマンス最適化 =====
performance_optimization:
  collection_efficiency:
    selective_capture:
      - priority_based_filtering
      - relevance_scoring
      - duplicate_elimination
      
    batch_optimization:
      - micro_batch_processing
      - compression_algorithms
      - indexing_strategies
      
  storage_optimization:
    tiered_storage:
      - hot_data: "ssd_storage"
      - warm_data: "standard_storage"
      - cold_data: "archive_storage"
      
    compression:
      - real_time_compression
      - archival_compression
      - format_optimization
      
  query_optimization:
    indexing_strategy:
      - value_hierarchy_index
      - temporal_index
      - relationship_index
      - quality_index
      
    caching_layers:
      - frequent_query_cache
      - relationship_cache
      - aggregation_cache

# ===== セキュリティ・プライバシー =====
security_privacy:
  data_protection:
    sensitive_data_handling:
      - automatic_detection
      - sanitization_rules
      - encryption_requirements
      
    access_control:
      - role_based_access
      - field_level_security
      - audit_logging
      
  compliance:
    data_retention:
      - retention_policies
      - automatic_deletion
      - legal_hold_support
      
    privacy_protection:
      - anonymization_techniques
      - consent_management
      - right_to_erasure

# ===== 監視・診断 =====
monitoring_diagnostics:
  collection_health:
    metrics:
      - collection_rate
      - processing_latency
      - error_rate
      - storage_utilization
      
    alerts:
      - collection_failure
      - processing_bottleneck
      - storage_threshold
      - quality_degradation
      
  system_performance:
    resource_monitoring:
      - cpu_utilization
      - memory_consumption
      - network_bandwidth
      - storage_iops
      
    capacity_planning:
      - growth_projection
      - resource_scaling
      - performance_optimization

# ===== API仕様 =====
api_interface:
  data_ingestion:
    endpoint: "POST /api/v1/collect"
    description: "データの手動投入"
    rate_limit: "1000/minute"
    
  query_interface:
    endpoint: "GET /api/v1/traces/query"
    description: "収集データの検索"
    parameters: ["filter", "sort", "limit", "offset"]
    
  subscription:
    endpoint: "POST /api/v1/subscribe"
    description: "リアルタイムデータ配信の購読"
    protocols: ["websocket", "sse"]
    
  export:
    endpoint: "GET /api/v1/export"
    description: "データのバッチエクスポート"
    formats: ["json", "csv", "parquet"]

# ===== 使用例 =====
usage_examples:
  phase_2_execution:
    captured_data:
      input: "価値分解の実行要求"
      context: "プロジェクト状態とユーザー入力"
      decisions: "VL1からVL3への分解ロジック"
      outputs: "価値階層とマイルストーン定義"
      
    enriched_data:
      relationships: "価値間の因果関係"
      quality_scores: "分解ロジックの妥当性"
      completeness: "必要情報の充足度"
      
  real_time_processing:
    input_stream: "Phase実行イベント"
    processing_steps:
      1. event_classification
      2. value_extraction
      3. relationship_mapping
      4. quality_assessment
    output_streams:
      - value_tracer_updates
      - necessity_evaluation_triggers
      - gate_validation_inputs